{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"themes/NINE/source/css/style.css","path":"css/style.css","modified":0,"renderable":1},{"_id":"themes/NINE/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"source/img/å¤´åƒ.jpg","path":"img/å¤´åƒ.jpg","modified":0,"renderable":0},{"_id":"source/img/background/Glowing-Star-Girl-4096x2160.mp4","path":"img/background/Glowing-Star-Girl-4096x2160.mp4","modified":0,"renderable":0},{"_id":"source/img/background/jk-åˆ¶æœ-åŠ¨æ¼«å¥³å­©.png","path":"img/background/jk-åˆ¶æœ-åŠ¨æ¼«å¥³å­©.png","modified":0,"renderable":0},{"_id":"source/img/background/äºŒæ¬¡å…ƒ-åŠ¨æ€å£çº¸.mp4","path":"img/background/äºŒæ¬¡å…ƒ-åŠ¨æ€å£çº¸.mp4","modified":0,"renderable":0},{"_id":"source/img/background/åŸå¸‚-å¤•é˜³.png","path":"img/background/åŸå¸‚-å¤•é˜³.png","modified":0,"renderable":0},{"_id":"source/img/background/äº‘å½©-å¤œæ™š-å¤œæ™¯.png","path":"img/background/äº‘å½©-å¤œæ™š-å¤œæ™¯.png","modified":0,"renderable":0},{"_id":"source/img/background/å¤ªç©ºäºº-å®‡å®™é¨æ¸¸.mp4","path":"img/background/å¤ªç©ºäºº-å®‡å®™é¨æ¸¸.mp4","modified":0,"renderable":0},{"_id":"source/img/background/æ˜Ÿç©º-é£æ™¯.png","path":"img/background/æ˜Ÿç©º-é£æ™¯.png","modified":0,"renderable":0}],"Cache":[{"_id":"source/_posts/RLHF çš„ä¸‰é˜¶æ®µæµç¨‹.md","hash":"775fb642d468b44f976f6355ac7c114dede2d0aa","modified":1770896600995},{"_id":"source/about/index.md","hash":"a2aa52d3b6d12a86a51e16a855c0b2bbfe7a8edc","modified":1770882888593},{"_id":"source/categories/index.md","hash":"480d9526bd8460484f94711c064fa4335a9a28d0","modified":1770882888593},{"_id":"source/friends/index.md","hash":"348de5bb1e3ecc1f9634d7ede320898a732a4be3","modified":1770882888593},{"_id":"source/tags/index.md","hash":"2fdd26bab9ba3416ad508d3cb3b96b6137472d24","modified":1770882888593},{"_id":"source/img/å¤´åƒ.jpg","hash":"75b6dac2f895ebf94326088adc7ee73d43ab6115","modified":1770882883970},{"_id":"themes/NINE/_config.yml","hash":"c23d19a271b9f0b86ff0f34da879d3e5816e7fad","modified":1770892805719},{"_id":"themes/NINE/layout/index.ejs","hash":"eca67f0756e0ef9931e53f6d6a2ff77a1236ded7","modified":1770882888598},{"_id":"themes/NINE/layout/layout.ejs","hash":"85bbd88e71e09740f069a490f5829ce171e5bc60","modified":1770896228831},{"_id":"themes/NINE/layout/archive.ejs","hash":"40cd9cac697e0b28cb40ba5af02362ea0d063f36","modified":1770882888598},{"_id":"themes/NINE/layout/post.ejs","hash":"54e5a6b1bec0c85401cb11fc924c93c6438531b8","modified":1770882888598},{"_id":"themes/NINE/layout/_partial/footer.ejs","hash":"b12e9e7683556a7ae6afaeb2334fb1f83abed9fb","modified":1770887824131},{"_id":"themes/NINE/layout/_partial/comment.ejs","hash":"1acbead04be653f259116bde998d6a5bac9d4274","modified":1770882888593},{"_id":"themes/NINE/layout/page.ejs","hash":"7a05be7a7bb8cf4ef731ea6041d4429604d8ccf0","modified":1770882888598},{"_id":"themes/NINE/layout/_partial/header.ejs","hash":"0e6071c7009c7fdac9d37a893ad6479c4889cb6a","modified":1770885984574},{"_id":"themes/NINE/layout/_partial/music.ejs","hash":"1e8e9d57906249196340702480f79d610cd8e3ea","modified":1770895800781},{"_id":"themes/NINE/layout/_partial/pagination.ejs","hash":"562c5e2bb7a5260c9d4391f67717eb5851f7fea2","modified":1770882888597},{"_id":"themes/NINE/layout/_partial/post-card.ejs","hash":"d803f508484bb0d32c1a104c644336db5a8c2229","modified":1770882888598},{"_id":"themes/NINE/source/css/style.css","hash":"03b3997cb00060294fdcc19386f527da1b4e27a2","modified":1770888708167},{"_id":"themes/NINE/source/js/main.js","hash":"dbb1bd5296f64a96f701f8b6e134d2e6617f7c8d","modified":1770888628070},{"_id":"source/img/background/jk-åˆ¶æœ-åŠ¨æ¼«å¥³å­©.png","hash":"fe6faad07101562a94f556c28591eaa7354d64e8","modified":1770895491225},{"_id":"source/img/background/åŸå¸‚-å¤•é˜³.png","hash":"00aeda7c7131a6aa25ff8df5e6b890899ecf660f","modified":1770895491247},{"_id":"source/img/background/æ˜Ÿç©º-é£æ™¯.png","hash":"eaa92a4349887f60c2dcf9960f6ae5ea44d3ff0b","modified":1770895491247},{"_id":"source/img/background/äº‘å½©-å¤œæ™š-å¤œæ™¯.png","hash":"e41027e74f4e3e27705e8de455cffeaa95f4da6a","modified":1770895491247},{"_id":"source/img/background/äºŒæ¬¡å…ƒ-åŠ¨æ€å£çº¸.mp4","hash":"764866185aee93ed6d62bda46b07d1867047e53d","modified":1770882883801},{"_id":"source/img/background/Glowing-Star-Girl-4096x2160.mp4","hash":"078254f9024c6805d8c0cb76ebc125222375f910","modified":1770895145998},{"_id":"source/img/background/å¤ªç©ºäºº-å®‡å®™é¨æ¸¸.mp4","hash":"e107ce2dc3942d4a16f819ed8b7a38f2e23817ce","modified":1770882883965},{"_id":"public/search.xml","hash":"193c400380dcf069b5db82562be3e75d019e146e","modified":1770897380803},{"_id":"public/atom.xml","hash":"318d66405750869f7cddcb729b5df44b1b5ebea9","modified":1770897380803},{"_id":"public/sitemap.xml","hash":"ffbba12f12f728989ca986e9b185294dae83ac0d","modified":1770896481383},{"_id":"public/friends/index.html","hash":"7f1868caa36d1345dfd6a50ea2e0e37ced0abc9f","modified":1770896481383},{"_id":"public/tags/index.html","hash":"36c08fbed928af56e895b48fe070b7c2bdba609b","modified":1770896481383},{"_id":"public/about/index.html","hash":"3568ddf23a8a2fa9c50f78ac9e8dee1ee31f34c8","modified":1770896481383},{"_id":"public/categories/index.html","hash":"122517f752d0916630f36b18359bac4bd34ffc5f","modified":1770896481383},{"_id":"public/2026/02/12/RLHF çš„ä¸‰é˜¶æ®µæµç¨‹/index.html","hash":"3efcc19c90c4ce6dfb1b9fc404e919173f6c8ad7","modified":1770897380803},{"_id":"public/categories/ç®—æ³•/index.html","hash":"e372b609cd0efe6d962d60ed680b161212c05404","modified":1770896481383},{"_id":"public/archives/index.html","hash":"9404e1bb50e02cbd69ad82412ac57969186ed45a","modified":1770896481383},{"_id":"public/index.html","hash":"c410260c00a9a2b2bafcbc7415f840105983f7c1","modified":1770897380803},{"_id":"public/archives/2026/index.html","hash":"b9b3d170e11a7527d06ff4589645c68bf2cb6346","modified":1770896481383},{"_id":"public/archives/2026/02/index.html","hash":"af1ef2476e24402c64b4850720dac623693adee2","modified":1770896481383},{"_id":"public/tags/LLM/index.html","hash":"820f84e3c5266196e21a864c88fb335aa1769cc6","modified":1770896481383},{"_id":"public/img/å¤´åƒ.jpg","hash":"75b6dac2f895ebf94326088adc7ee73d43ab6115","modified":1770896481383},{"_id":"public/assets/js/APlayer.min.js","hash":"22caa28ff6b41a16ff40f15d38f1739e22359478","modified":1770896481383},{"_id":"public/assets/css/APlayer.min.css","hash":"07372a2ba507388d0fed166d761b1c2c2a659dce","modified":1770896481383},{"_id":"public/js/main.js","hash":"c0fb5d533c1446bf0a59051883e738a4cf0db1eb","modified":1770896481383},{"_id":"public/css/style.css","hash":"d4904f8327be68ed0c00083f485a39f91381fd12","modified":1770896481383},{"_id":"public/assets/js/Meting.min.js","hash":"a0585220b918d78649a7893279e1ec4fb5abe835","modified":1770896481383},{"_id":"public/img/background/åŸå¸‚-å¤•é˜³.png","hash":"00aeda7c7131a6aa25ff8df5e6b890899ecf660f","modified":1770896481383},{"_id":"public/img/background/jk-åˆ¶æœ-åŠ¨æ¼«å¥³å­©.png","hash":"fe6faad07101562a94f556c28591eaa7354d64e8","modified":1770896481383},{"_id":"public/img/background/æ˜Ÿç©º-é£æ™¯.png","hash":"eaa92a4349887f60c2dcf9960f6ae5ea44d3ff0b","modified":1770896481383},{"_id":"public/img/background/äº‘å½©-å¤œæ™š-å¤œæ™¯.png","hash":"e41027e74f4e3e27705e8de455cffeaa95f4da6a","modified":1770896481383},{"_id":"public/img/background/äºŒæ¬¡å…ƒ-åŠ¨æ€å£çº¸.mp4","hash":"764866185aee93ed6d62bda46b07d1867047e53d","modified":1770896481383},{"_id":"public/img/background/Glowing-Star-Girl-4096x2160.mp4","hash":"078254f9024c6805d8c0cb76ebc125222375f910","modified":1770896481383},{"_id":"public/img/background/å¤ªç©ºäºº-å®‡å®™é¨æ¸¸.mp4","hash":"e107ce2dc3942d4a16f819ed8b7a38f2e23817ce","modified":1770896481383}],"Category":[{"name":"ç®—æ³•","_id":"cmlje1itv000380zk2jni2ghq"}],"Data":[],"Page":[{"title":"æ ‡ç­¾","date":"2025-02-11T16:00:00.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: æ ‡ç­¾\ndate: 2025-02-12\ntype: tags\n---\n","updated":"2026-02-12T07:54:48.593Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cmlje1itr000080zk0jxkdtpp","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script>","excerpt":"","more":""},{"title":"å‹æƒ…é“¾æ¥","date":"2025-02-11T16:00:00.000Z","type":"friends","_content":"\næ¬¢è¿äº¤æ¢å‹é“¾ï¼è¯·åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç«™ç‚¹ä¿¡æ¯ï¼š\n\n- **ç«™ç‚¹åç§°**\n- **ç«™ç‚¹åœ°å€**\n- **å¤´åƒé“¾æ¥**\n- **ä¸€å¥è¯æè¿°**\n","source":"friends/index.md","raw":"---\ntitle: å‹æƒ…é“¾æ¥\ndate: 2025-02-12\ntype: friends\n---\n\næ¬¢è¿äº¤æ¢å‹é“¾ï¼è¯·åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç«™ç‚¹ä¿¡æ¯ï¼š\n\n- **ç«™ç‚¹åç§°**\n- **ç«™ç‚¹åœ°å€**\n- **å¤´åƒé“¾æ¥**\n- **ä¸€å¥è¯æè¿°**\n","updated":"2026-02-12T07:54:48.593Z","path":"friends/index.html","comments":1,"layout":"page","_id":"cmlje1itv000280zkarfd73dy","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>æ¬¢è¿äº¤æ¢å‹é“¾ï¼è¯·åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç«™ç‚¹ä¿¡æ¯ï¼š</p>\n<ul>\n<li><strong>ç«™ç‚¹åç§°</strong></li>\n<li><strong>ç«™ç‚¹åœ°å€</strong></li>\n<li><strong>å¤´åƒé“¾æ¥</strong></li>\n<li><strong>ä¸€å¥è¯æè¿°</strong></li>\n</ul>\n","excerpt":"","more":"<p>æ¬¢è¿äº¤æ¢å‹é“¾ï¼è¯·åœ¨è¯„è®ºåŒºç•™ä¸‹ä½ çš„ç«™ç‚¹ä¿¡æ¯ï¼š</p>\n<ul>\n<li><strong>ç«™ç‚¹åç§°</strong></li>\n<li><strong>ç«™ç‚¹åœ°å€</strong></li>\n<li><strong>å¤´åƒé“¾æ¥</strong></li>\n<li><strong>ä¸€å¥è¯æè¿°</strong></li>\n</ul>\n"},{"title":"å…³äºæˆ‘","date":"2025-02-11T16:00:00.000Z","type":"about","_content":"\n## ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯ ZhenWusi\n\nä¸€ä¸ªçƒ­çˆ±æŠ€æœ¯ã€å–œæ¬¢æŠ˜è…¾çš„å¼€å‘è€…ã€‚\n\n> ä»£ç æ”¹å˜ä¸–ç•Œï¼ŒæŠ€æœ¯ç‚¹äº®ç”Ÿæ´»ã€‚\n\n## ğŸ› ï¸ æŠ€æœ¯æ ˆ\n\n- **å‰ç«¯**ï¼šHTML5 / CSS3 / JavaScript / Vue / React\n- **åç«¯**ï¼šNode.js / Python / Java\n- **å·¥å…·**ï¼šGit / Docker / Linux / VS Code\n- **å…¶ä»–**ï¼šMarkdown / Hexo / GitHub Pages\n\n## ğŸ¯ å…³äºæœ¬ç«™\n\nè¿™ä¸ªåšå®¢åŸºäº [Hexo](https://hexo.io/) æ„å»ºï¼Œæ‰˜ç®¡åœ¨ [GitHub Pages](https://pages.github.com/) ä¸Šã€‚\n\nä¸»è¦è®°å½•ï¼š\n\n- ğŸ“ æŠ€æœ¯å­¦ä¹ ç¬”è®°\n- ğŸ’¡ é¡¹ç›®å¼€å‘ç»éªŒ\n- ğŸ”§ å®ç”¨å·¥å…·åˆ†äº«\n- ğŸŒ± ä¸ªäººæˆé•¿æ„Ÿæ‚Ÿ\n\n## ğŸ“¬ è”ç³»æ–¹å¼\n\n- **GitHub**ï¼š[ZhenWusi](https://github.com/ZhenWusi)\n- **é‚®ç®±**ï¼šzhenwusi@example.com\n\n---\n\næ„Ÿè°¢ä½ çš„æ¥è®¿ï¼Œæ¬¢è¿äº¤æµï¼âœ¨\n","source":"about/index.md","raw":"---\ntitle: å…³äºæˆ‘\ndate: 2025-02-12\ntype: about\n---\n\n## ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯ ZhenWusi\n\nä¸€ä¸ªçƒ­çˆ±æŠ€æœ¯ã€å–œæ¬¢æŠ˜è…¾çš„å¼€å‘è€…ã€‚\n\n> ä»£ç æ”¹å˜ä¸–ç•Œï¼ŒæŠ€æœ¯ç‚¹äº®ç”Ÿæ´»ã€‚\n\n## ğŸ› ï¸ æŠ€æœ¯æ ˆ\n\n- **å‰ç«¯**ï¼šHTML5 / CSS3 / JavaScript / Vue / React\n- **åç«¯**ï¼šNode.js / Python / Java\n- **å·¥å…·**ï¼šGit / Docker / Linux / VS Code\n- **å…¶ä»–**ï¼šMarkdown / Hexo / GitHub Pages\n\n## ğŸ¯ å…³äºæœ¬ç«™\n\nè¿™ä¸ªåšå®¢åŸºäº [Hexo](https://hexo.io/) æ„å»ºï¼Œæ‰˜ç®¡åœ¨ [GitHub Pages](https://pages.github.com/) ä¸Šã€‚\n\nä¸»è¦è®°å½•ï¼š\n\n- ğŸ“ æŠ€æœ¯å­¦ä¹ ç¬”è®°\n- ğŸ’¡ é¡¹ç›®å¼€å‘ç»éªŒ\n- ğŸ”§ å®ç”¨å·¥å…·åˆ†äº«\n- ğŸŒ± ä¸ªäººæˆé•¿æ„Ÿæ‚Ÿ\n\n## ğŸ“¬ è”ç³»æ–¹å¼\n\n- **GitHub**ï¼š[ZhenWusi](https://github.com/ZhenWusi)\n- **é‚®ç®±**ï¼šzhenwusi@example.com\n\n---\n\næ„Ÿè°¢ä½ çš„æ¥è®¿ï¼Œæ¬¢è¿äº¤æµï¼âœ¨\n","updated":"2026-02-12T07:54:48.593Z","path":"about/index.html","comments":1,"layout":"page","_id":"cmlje1itx000780zkewe51qiz","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"ğŸ‘‹-ä½ å¥½ï¼Œæˆ‘æ˜¯-ZhenWusi\"><a href=\"#ğŸ‘‹-ä½ å¥½ï¼Œæˆ‘æ˜¯-ZhenWusi\" class=\"headerlink\" title=\"ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯ ZhenWusi\"></a>ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯ ZhenWusi</h2><p>ä¸€ä¸ªçƒ­çˆ±æŠ€æœ¯ã€å–œæ¬¢æŠ˜è…¾çš„å¼€å‘è€…ã€‚</p>\n<blockquote>\n<p>ä»£ç æ”¹å˜ä¸–ç•Œï¼ŒæŠ€æœ¯ç‚¹äº®ç”Ÿæ´»ã€‚</p>\n</blockquote>\n<h2 id=\"ğŸ› ï¸-æŠ€æœ¯æ ˆ\"><a href=\"#ğŸ› ï¸-æŠ€æœ¯æ ˆ\" class=\"headerlink\" title=\"ğŸ› ï¸ æŠ€æœ¯æ ˆ\"></a>ğŸ› ï¸ æŠ€æœ¯æ ˆ</h2><ul>\n<li><strong>å‰ç«¯</strong>ï¼šHTML5 / CSS3 / JavaScript / Vue / React</li>\n<li><strong>åç«¯</strong>ï¼šNode.js / Python / Java</li>\n<li><strong>å·¥å…·</strong>ï¼šGit / Docker / Linux / VS Code</li>\n<li><strong>å…¶ä»–</strong>ï¼šMarkdown / Hexo / GitHub Pages</li>\n</ul>\n<h2 id=\"ğŸ¯-å…³äºæœ¬ç«™\"><a href=\"#ğŸ¯-å…³äºæœ¬ç«™\" class=\"headerlink\" title=\"ğŸ¯ å…³äºæœ¬ç«™\"></a>ğŸ¯ å…³äºæœ¬ç«™</h2><p>è¿™ä¸ªåšå®¢åŸºäº <a href=\"https://hexo.io/\">Hexo</a> æ„å»ºï¼Œæ‰˜ç®¡åœ¨ <a href=\"https://pages.github.com/\">GitHub Pages</a> ä¸Šã€‚</p>\n<p>ä¸»è¦è®°å½•ï¼š</p>\n<ul>\n<li>ğŸ“ æŠ€æœ¯å­¦ä¹ ç¬”è®°</li>\n<li>ğŸ’¡ é¡¹ç›®å¼€å‘ç»éªŒ</li>\n<li>ğŸ”§ å®ç”¨å·¥å…·åˆ†äº«</li>\n<li>ğŸŒ± ä¸ªäººæˆé•¿æ„Ÿæ‚Ÿ</li>\n</ul>\n<h2 id=\"ğŸ“¬-è”ç³»æ–¹å¼\"><a href=\"#ğŸ“¬-è”ç³»æ–¹å¼\" class=\"headerlink\" title=\"ğŸ“¬ è”ç³»æ–¹å¼\"></a>ğŸ“¬ è”ç³»æ–¹å¼</h2><ul>\n<li><strong>GitHub</strong>ï¼š<a href=\"https://github.com/ZhenWusi\">ZhenWusi</a></li>\n<li><strong>é‚®ç®±</strong>ï¼šzhenwusi@example.com</li>\n</ul>\n<hr>\n<p>æ„Ÿè°¢ä½ çš„æ¥è®¿ï¼Œæ¬¢è¿äº¤æµï¼âœ¨</p>\n","excerpt":"","more":"<h2 id=\"ğŸ‘‹-ä½ å¥½ï¼Œæˆ‘æ˜¯-ZhenWusi\"><a href=\"#ğŸ‘‹-ä½ å¥½ï¼Œæˆ‘æ˜¯-ZhenWusi\" class=\"headerlink\" title=\"ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯ ZhenWusi\"></a>ğŸ‘‹ ä½ å¥½ï¼Œæˆ‘æ˜¯ ZhenWusi</h2><p>ä¸€ä¸ªçƒ­çˆ±æŠ€æœ¯ã€å–œæ¬¢æŠ˜è…¾çš„å¼€å‘è€…ã€‚</p>\n<blockquote>\n<p>ä»£ç æ”¹å˜ä¸–ç•Œï¼ŒæŠ€æœ¯ç‚¹äº®ç”Ÿæ´»ã€‚</p>\n</blockquote>\n<h2 id=\"ğŸ› ï¸-æŠ€æœ¯æ ˆ\"><a href=\"#ğŸ› ï¸-æŠ€æœ¯æ ˆ\" class=\"headerlink\" title=\"ğŸ› ï¸ æŠ€æœ¯æ ˆ\"></a>ğŸ› ï¸ æŠ€æœ¯æ ˆ</h2><ul>\n<li><strong>å‰ç«¯</strong>ï¼šHTML5 / CSS3 / JavaScript / Vue / React</li>\n<li><strong>åç«¯</strong>ï¼šNode.js / Python / Java</li>\n<li><strong>å·¥å…·</strong>ï¼šGit / Docker / Linux / VS Code</li>\n<li><strong>å…¶ä»–</strong>ï¼šMarkdown / Hexo / GitHub Pages</li>\n</ul>\n<h2 id=\"ğŸ¯-å…³äºæœ¬ç«™\"><a href=\"#ğŸ¯-å…³äºæœ¬ç«™\" class=\"headerlink\" title=\"ğŸ¯ å…³äºæœ¬ç«™\"></a>ğŸ¯ å…³äºæœ¬ç«™</h2><p>è¿™ä¸ªåšå®¢åŸºäº <a href=\"https://hexo.io/\">Hexo</a> æ„å»ºï¼Œæ‰˜ç®¡åœ¨ <a href=\"https://pages.github.com/\">GitHub Pages</a> ä¸Šã€‚</p>\n<p>ä¸»è¦è®°å½•ï¼š</p>\n<ul>\n<li>ğŸ“ æŠ€æœ¯å­¦ä¹ ç¬”è®°</li>\n<li>ğŸ’¡ é¡¹ç›®å¼€å‘ç»éªŒ</li>\n<li>ğŸ”§ å®ç”¨å·¥å…·åˆ†äº«</li>\n<li>ğŸŒ± ä¸ªäººæˆé•¿æ„Ÿæ‚Ÿ</li>\n</ul>\n<h2 id=\"ğŸ“¬-è”ç³»æ–¹å¼\"><a href=\"#ğŸ“¬-è”ç³»æ–¹å¼\" class=\"headerlink\" title=\"ğŸ“¬ è”ç³»æ–¹å¼\"></a>ğŸ“¬ è”ç³»æ–¹å¼</h2><ul>\n<li><strong>GitHub</strong>ï¼š<a href=\"https://github.com/ZhenWusi\">ZhenWusi</a></li>\n<li><strong>é‚®ç®±</strong>ï¼šzhenwusi@example.com</li>\n</ul>\n<hr>\n<p>æ„Ÿè°¢ä½ çš„æ¥è®¿ï¼Œæ¬¢è¿äº¤æµï¼âœ¨</p>\n"},{"title":"åˆ†ç±»","date":"2025-02-11T16:00:00.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: åˆ†ç±»\ndate: 2025-02-12\ntype: categories\n---\n","updated":"2026-02-12T07:54:48.593Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cmlje1ity000880zkfrl7flkb","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script>","excerpt":"","more":""}],"Post":[{"title":"RLHF çš„ä¸‰é˜¶æ®µæµç¨‹","date":"2026-02-11T16:00:00.000Z","excerpt":"æ·±å…¥ç†è§£ RLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰çš„ä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µ","_content":"\n## åŸºç¡€çŸ¥è¯†\n### RLHF çš„ä¸‰é˜¶æ®µæµç¨‹\nRLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰é€šå¸¸åŒ…å«ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š\n\n**ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰â†’ åå¥½é‡‡æ · + å¥–åŠ±æ¨¡å‹å­¦ä¹  â†’ å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼ˆRLï¼‰**\n\nç®€å•å¯ä»¥ç†è§£ä¸ºï¼šå…ˆå­¦\"æ€ä¹ˆè¯´è¯\"ï¼Œå†å­¦\"ä»€ä¹ˆè¯æ›´å¥½\"ï¼Œæœ€åé€¼æ¨¡å‹å¤šè¯´\"å¥½è¯\"\n\n#### é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised Fine-Tuningï¼‰\nRLHF é€šå¸¸ä»å¯¹ä¸€ä¸ªé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œç›‘ç£å¾®è°ƒå¼€å§‹ï¼Œä½¿ç”¨é«˜è´¨é‡çš„äººå·¥æ•°æ®ï¼ˆå¦‚å¯¹è¯ã€æ‘˜è¦ç­‰ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡å‹ $\\pi\\_{SFT}$ã€‚\n\n**æ•°æ®å½¢å¼**ï¼š$(\\text{prompt } x, \\text{é«˜è´¨é‡å›ç­” } y)$\n\n**æŸå¤±å‡½æ•°**ï¼šæ ‡å‡†çš„ç›‘ç£å­¦ä¹ æŸå¤±å‡½æ•°\n\n$$\\max_{\\theta} \\sum_{(x,y) \\in D} \\log \\pi_\\theta(y|x)$$\n\n+ $\\pi\\_\\theta$ï¼šç­–ç•¥æ¨¡å‹çš„å‚æ•°åŒ–å½¢å¼\n+ $D$ï¼šç›‘ç£å¾®è°ƒæ•°æ®é›†\n+ $x$ï¼šè¾“å…¥æç¤º\n+ $y$ï¼šç›®æ ‡å›ç­”\n\n**ç›®æ ‡**ï¼šè®©æ¨¡å‹å­¦ä¼šåŸºæœ¬çš„å¯¹è¯èƒ½åŠ›å’Œä»»åŠ¡å®Œæˆèƒ½åŠ›ï¼Œå³\"æ€ä¹ˆè¯´è¯\"\n\n#### é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward Modelingï¼‰\nä½¿ç”¨ SFT æ¨¡å‹ï¼Œå¯¹åŒä¸€ä¸ª prompt $x$ é‡‡æ ·ä¸¤ä¸ªå›ç­”ï¼š\n\n$$y_1, y_2 \\sim \\pi_{SFT}(y|x)$$\n\näº¤ç»™äººç±»æ ‡æ³¨è€…ï¼Œè®©ä»–ä»¬é€‰æ›´å¥½çš„ä¸€ä¸ªï¼š\n\n$$y_w \\succ y_l \\mid x$$\n\n+ $y_w$ï¼šwinner,preferredï¼ˆèµ¢å®¶ï¼‰\n+ $y_l$ï¼šloser,rejectedï¼ˆè¾“å®¶ï¼‰\n\n\n\n**æ½œåœ¨å¥–åŠ±å‡½æ•°å‡è®¾**ï¼šå‡è®¾äººç±»åå¥½æ˜¯ç”±ä¸€ä¸ªæœªçŸ¥çš„çœŸå®å¥–åŠ±å‡½æ•° $r^*(x,y)$ ç”Ÿæˆçš„ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒï¼Œä½†å‡è®¾å®ƒå­˜åœ¨ã€‚\n\n\n\n**åå¥½æ¨¡å‹**ï¼š\n\n$$p^*(y_1 > y_2 | x) = \\frac{\\exp(r^*(x, y_1))}{\\exp(r^*(x, y_1)) + \\exp(r^*(x, y_2))} \\tag{1}$$\n\n**æ•°æ®é›†å½¢å¼**ï¼š\n\n$$D = \\{(x^{(i)}, y_w^{(i)}, y_l^{(i)})\\}_{i=1}^N$$\n\n**æŸå¤±å‡½æ•°**ï¼š\n\n$$\\mathcal{L}_\\text{R}(r_\\phi, \\mathcal{D}) = -\\mathbb{E}_{(x, y_w, y_l) \\sim \\mathcal{D}} \\left[ \\log \\sigma (r_\\phi(x, y_w) - r_\\phi(x, y_l)) \\right] \\tag{2}$$\n\n---\n\n##### è¡¥å……è§£é‡Š\nBT æ¨¡å‹ï¼š\n\nBradley-Terry æ¨¡å‹æ˜¯ä¸€ä¸ªç”¨äº**æˆå¯¹æ¯”è¾ƒ**çš„æ¦‚ç‡æ¨¡å‹\n\n**æ ¸å¿ƒæ€æƒ³**ï¼š\n\n+ æ¯ä¸ªå¯¹è±¡ $i$ æœ‰ä¸€ä¸ªéšè—çš„\"å®åŠ›å€¼\"å‚æ•° $\\lambda_i$\n+ å½“ä¸¤ä¸ªå¯¹è±¡ $i$ å’Œ $j$ æ¯”è¾ƒæ—¶ï¼Œ$i$ æˆ˜èƒœ $j$ çš„æ¦‚ç‡ä¸ºï¼š\n\n$$P(i \\succ j) = \\frac{\\lambda_i}{\\lambda_i + \\lambda_j}$$\n\n**åœ¨ DPO ä¸­çš„åº”ç”¨**ï¼š\n\n+ å°†å¥–åŠ±å‡½æ•° $r(x,y)$ çœ‹ä½œ\"å®åŠ›å€¼\"\n+ äººç±»åå¥½ $ y_w \\succ y_l $ å°±æ˜¯\"æ¯”è¾ƒç»“æœ\"\n+ é€šè¿‡ BT æ¨¡å‹å»ºç«‹å¥–åŠ±ä¸åå¥½çš„æ¡¥æ¢\n\n\n\nä¸ºä»€ä¹ˆä¸ç”¨ã€Œè°åˆ†æ•°å¤§å°±é€‰è°ã€ï¼Ÿ\n\nå¦‚æœç›´æ¥è§„å®šï¼š$$y_1 \\succ y_2 \\iff r^*(x,y_1) > r^*(x,y_2)$$  \né‚£é—®é¢˜æ˜¯ï¼šäººç±»åˆ¤æ–­æœ‰å™ªå£°ï¼ŒåŒä¸€ä¸ªäººã€åŒä¸€ä¸ªé—®é¢˜ï¼Œä¸ä¸€å®šæ¯æ¬¡é€‰åŒæ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å»ºæ¨¡æˆç¡®å®šæ€§è§„åˆ™ï¼Œè€Œæ˜¯ï¼šæ¦‚ç‡æ¨¡å‹\n\næŠŠå…¬å¼ (1) æ”¹å†™ä¸€ä¸‹ï¼š\n\n$$p^*(y_1 \\succ y_2 \\mid x) = \\frac{1}{1 + e^{-(r^*(x,y_1) - r^*(x,y_2))}}$$\n\nè¿™å°±æ˜¯ç†Ÿæ‚‰çš„ Sigmoid å‡½æ•°ï¼š\n\n$$\\sigma(z) = \\frac{1}{1 + e^{-z}}$$\n\näºæ˜¯ï¼š\n\n$$p^*(y_1 \\succ y_2 \\mid x) = \\sigma(r^*(x,y_1) - r^*(x,y_2))$$\n\nå› ä¸ºçœŸå®æ•°æ®é‡Œäººç¡®å®é€‰æ‹©äº† $ y_w $ï¼Œæ‰€ä»¥è¯¥äº‹ä»¶çš„æ¦‚ç‡æ˜¯ä¸Šå¼ï¼Œå¯¹æ•°ä¼¼ç„¶æ˜¯ï¼š\n\n$$\\log p_\\theta(y_w \\succ y_l \\mid x) = \\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))$$\n\næœ€å¤§åŒ–æ‰€æœ‰æ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ï¼š\n\n$$\\max_\\theta \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))$$\n\næ„æ€æ˜¯ï¼šå¯¹æ¯ä¸€æ¡æ•°æ®ï¼Œéƒ½ç®—ä¸€æ¬¡\"æ¨¡å‹è®¤ä¸ºäººç±»ä¼šé€‰èµ¢å®¶çš„æ¦‚ç‡çš„å¯¹æ•°\"ï¼Œç„¶åæŠŠå®ƒä»¬åŠ èµ·æ¥ï¼Œè®©è¿™ä¸ªæ€»å’Œå°½å¯èƒ½å¤§ã€‚å¯¹æ•°æŠŠâ€œè¿ä¹˜â€å˜æˆâ€œè¿åŠ â€,æœ€ä¼˜è§£ä¸å˜(å¯¹æ•°æ˜¯å•è°ƒé€’å¢å‡½æ•°)\n\nç­‰ä»·åœ°ï¼Œæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆLikelihoodï¼‰ï¼š\n\n$$L_R = -\\mathbb{E}_{(x,y_w,y_l) \\sim D} [\\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))]$$\n\nè¿™æ­£æ˜¯å…¬å¼ (2)ã€‚æ„æ€æ˜¯ï¼šå¯¹æ•°æ®é›†é‡Œçš„æ ·æœ¬å–å¹³å‡ï¼Œç„¶åå¯¹\"å¯¹æ•°æ¦‚ç‡\"å–è´Ÿå·ï¼Œè®©è¿™ä¸ªå€¼å°½å¯èƒ½å°ã€‚\n\n\n\nå¯¹ä¸€ä¸ªæœ‰é™æ•°æ®é›† $D = \\{z_1, ..., z_N\\}$ï¼Œå¦‚æœä½ å‡åŒ€éšæœºä»ä¸­æŠ½ä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆï¼š\n\n$$\\mathbb{E}_{z \\sim D} [f(z)] = \\frac{1}{N} \\sum_{i=1}^N f(z_i)$$\n\nğŸ‘‰ æœŸæœ› = å¹³å‡å€¼\n\nä»¤ $f(x,y\\_w,y\\_l) = \\log \\sigma(r\\_\\theta(x,y\\_w) - r\\_\\theta(x,y\\_l))$ é‚£ä¹ˆï¼š\n\n$$\\mathbb{E}_{(x,y_w,y_l) \\sim D} [f] = \\frac{1}{N} \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))$$\n\nå› ä¸º $\\sum\\_{i=1}^N f\\_i$ å’Œ $\\frac{1}{N} \\sum\\_{i=1}^N f\\_i$ åªå·®ä¸€ä¸ªå¸¸æ•° $\\frac{1}{N}$ã€‚è€Œåœ¨ä¼˜åŒ–ä¸­ï¼šä¹˜ä»¥ä¸€ä¸ªæ­£çš„å¸¸æ•°ï¼Œä¸ä¼šæ”¹å˜æœ€ä¼˜è§£çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š$$\\arg\\max\\_\\theta \\sum\\_{i=1}^N f\\_i = \\arg\\max\\_\\theta \\frac{1}{N} \\sum\\_{i=1}^N f\\_i$$\n\nåŸç›®æ ‡ï¼š$$\\max_\\theta \\mathbb{E}_D [\\log \\sigma(\\cdots)]$$\n\nç­‰ä»·äºï¼š$$\\min_\\theta -\\mathbb{E}_D [\\log \\sigma(\\cdots)]$$\n\näºæ˜¯å®šä¹‰ï¼š$$L_R = -\\mathbb{E}_D [\\log \\sigma(\\cdots)]$$\n\n**ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ é‡Œ\"æ€»æ˜¯æœ€å°åŒ–\"ï¼Ÿ**\n\nå› ä¸ºæ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰é»˜è®¤æ˜¯ minimize lossï¼Œæ‰€ä»¥å¤§å®¶ä¹ æƒ¯ï¼šæŠŠ\"æƒ³æœ€å¤§åŒ–çš„ç›®æ ‡\"ï¼Œå†™æˆ\"è¦æœ€å°åŒ–çš„æŸå¤±\"ã€‚\n\n---\n\n#### é˜¶æ®µä¸‰ï¼šRL å¾®è°ƒ\n**RL ç›®æ ‡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰**ï¼š\n\n$$\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r_\\phi(x, y) - \\beta D_{\\text{KL}} \\left[ \\pi_\\theta(y|x) \\middle\\| \\pi_{\\text{ref}}(y|x) \\right] \\right] \\tag{3}$$\n\n---\n\n##### è¡¥å……è§£é‡Š\nä¸€å¥è¯è§£é‡Šï¼šğŸ‘‰ è®©æ¨¡å‹ç”Ÿæˆ å¥–åŠ±é«˜çš„å›ç­” ğŸ‘‰ ä½†ä¸èƒ½åç¦»åŸå§‹ SFT æ¨¡å‹å¤ªè¿œ\n\n\n\n$\\pi\\_{ref}$ï¼ˆå³åˆå§‹ SFT æ¨¡å‹ $\\pi\\_{SFT}$ï¼‰å®è·µä¸­ï¼Œè¯­è¨€æ¨¡å‹ç­–ç•¥ $\\pi\\_\\theta$ ä¹Ÿè¢«åˆå§‹åŒ–ä¸º $\\pi\\_{SFT}$ã€‚\n\n+ **åˆå§‹çŠ¶æ€**ï¼š$\\pi\\_\\theta = \\pi\\_{ref} = \\pi\\_{SFT}$\n+ **è®­ç»ƒç›®æ ‡**ï¼šåœ¨ä¿æŒä¸åŸå§‹ SFT æ¨¡å‹æ¥è¿‘çš„å‰æä¸‹ï¼Œä¼˜åŒ–å¥–åŠ±\n+ **KL çº¦æŸä½œç”¨**ï¼šç¡®ä¿æ¨¡å‹ä¸ä¼šåç¦»åˆå§‹èƒ½åŠ›å¤ªè¿œ\n\n**KL çº¦æŸï¼š**\n\nKL æ•£åº¦ï¼ˆKullback-Leibler æ•£åº¦ï¼‰è¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼š\n\n$$D_{\\text{KL}}[P \\| Q] = \\sum_x P(x) \\log \\frac{P(x)}{Q(x)}$$\n\n$$D_{\\text{KL}}[\\pi_\\theta(y|x) \\| \\pi_{SFT}(y|x)] = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]$$\n\nè¿™è¡¨ç¤ºï¼š\n\n+ å¦‚æœ $\\pi\\_\\theta$ å’Œ $\\pi\\_{SFT}$ ç›¸åŒï¼šKL = 0\n+ å¦‚æœ $\\pi\\_\\theta$ åç¦» $\\pi\\_{SFT}$ï¼šKL > 0\n+ ç›®æ ‡å‡½æ•°ä¸­çš„ $-\\beta KL$ æƒ©ç½šåç¦»è¡Œä¸º\n\n\n\n**KL æ•£åº¦æ¨å¯¼è¿‡ç¨‹è¯¦è§£**\n\n**KL æ•£åº¦çš„é€šç”¨å®šä¹‰ï¼ˆç¦»æ•£å‹ï¼‰**ï¼š\n\n$$D_{\\text{KL}}[P \\| Q] = \\sum_i P(i) \\log \\frac{P(i)}{Q(i)}$$\n\n**æœŸæœ›çš„å®šä¹‰**ï¼š  \nå¯¹äºéšæœºå˜é‡ $Y \\sim P$ï¼Œå‡½æ•° $f(Y)$ çš„æœŸæœ›å®šä¹‰ä¸ºï¼š\n\n$$\\mathbb{E}_{Y \\sim P}[f(Y)] = \\sum_{y \\in \\mathcal{Y}} P(y) f(y)$$\n\n**è¿›è¡Œå˜é‡æ˜ å°„**\n\nåœ¨ RLHF çš„è¯­å¢ƒä¸‹ï¼Œæˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯ä¸¤ä¸ªæ¨¡å‹ç­–ç•¥ï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰ä¹‹é—´çš„å·®å¼‚ï¼š\n\n+ $P$** (å½“å‰åˆ†å¸ƒ)**ï¼š$\\pi\\_\\theta(y|x)$ â€”â€” æ¨¡å‹å½“å‰æ­£åœ¨å­¦ä¹ çš„ç­–ç•¥\n+ $Q$** (å‚è€ƒåˆ†å¸ƒ)**ï¼š$\\pi\\_{SFT}(y|x)$ â€”â€” åŸå§‹çš„ SFT ç­–ç•¥\n+ **æ ·æœ¬ç©ºé—´**ï¼š$y$ï¼ˆæ¨¡å‹ç”Ÿæˆçš„æ‰€æœ‰å¯èƒ½çš„å›ç­”åºåˆ—ï¼‰\n\nå°†è¿™äº›ä»£å…¥é€šç”¨å…¬å¼ï¼š\n\n$$D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\sum_y \\pi_\\theta(y|x) \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)}$$\n\n**è½¬åŒ–ä¸ºæœŸæœ›å½¢å¼**\n\n+ å¤–å±‚çš„ $\\sum\\_y \\pi\\_\\theta(y|x)(\\cdots)$ è¡¨ç¤ºæˆ‘ä»¬åœ¨æŒ‰ç…§ $\\pi\\_\\theta(y|x)$ çš„æ¦‚ç‡åˆ†å¸ƒå¯¹åé¢çš„é¡¹è¿›è¡ŒåŠ æƒå¹³å‡\n+ æ‹¬å·é‡Œçš„é¡¹ $\\log \\frac{\\pi\\_\\theta(y|x)}{\\pi\\_{SFT}(y|x)}$ å°±æ˜¯è¦è®¡ç®—æœŸæœ›çš„å¯¹è±¡\n\nå› æ­¤ï¼Œæ ¹æ®æœŸæœ›çš„å®šä¹‰ $ \\sum P \\cdot f = \\mathbb{E}_P[f] $ï¼Œå¯ä»¥ç›´æ¥å†™æˆï¼š\n\n$$D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\mathbb{E}_{y \\sim \\pi_\\theta(y|x)} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]$$\n\n**ä¸ºä»€ä¹ˆå®è·µä¸­è¦å†™æˆæœŸæœ›å½¢å¼ï¼Ÿ**\n\nåœ¨æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ä¸­ï¼Œå†™æˆæœŸæœ›å½¢å¼æœ‰é‡å¤§çš„å·¥ç¨‹æ„ä¹‰ï¼š\n\n**æ— æ³•å…¨é‡æ±‚å’Œ**ï¼š  \nå¯¹äºè¯­è¨€æ¨¡å‹ï¼Œå¯èƒ½çš„å›ç­” $y$ çš„ç»„åˆæ˜¯å¤©æ–‡æ•°å­—ï¼ˆç”±è¯è¡¨å¤§å°å’Œåºåˆ—é•¿åº¦å†³å®šï¼‰ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•éå†æ‰€æœ‰çš„ $y$ æ¥è®¡ç®—é‚£ä¸ª $\\sum$ ç¬¦å·ã€‚\n\n**è’™ç‰¹å¡æ´›é‡‡æ ·ï¼ˆMonte Carlo Samplingï¼‰**ï¼š  \næœŸæœ›å½¢å¼å‘Šè¯‰æˆ‘ä»¬ï¼Œè™½ç„¶ä¸èƒ½éå†æ‰€æœ‰ç»“æœï¼Œä½†å¯ä»¥é€šè¿‡é‡‡æ ·æ¥è¿‘ä¼¼ï¼šè®©æ¨¡å‹ $\\pi\\_\\theta$ ç”Ÿæˆï¼ˆSampleï¼‰ä¸€æ‰¹å¥å­ $y$,è®¡ç®—è¿™äº›å¥å­çš„ $\\log \\pi\\_\\theta(y|x) - \\log \\pi\\_{SFT}(y|x)$,å–è¿™äº›å€¼çš„å¹³å‡å€¼ï¼Œå°±æ˜¯å¯¹ KL æ•£åº¦çš„æ— åä¼°è®¡\n\n**å¯¹é½ç›®æ ‡å‡½æ•°**ï¼š  \nRL çš„ç›®æ ‡å‡½æ•°æœ¬èº«å°±æ˜¯æœ€å¤§åŒ–æœŸæœ›å¥–åŠ± $\\mathbb{E}\\_{y \\sim \\pi\\_\\theta}[r(x,y)]$ã€‚å°† KL çº¦æŸä¹Ÿå†™æˆæœŸæœ›å½¢å¼ï¼Œå°±å¯ä»¥åˆå¹¶åˆ°ä¸€ä¸ªå¤§æ‹¬å·é‡Œï¼š\n\n$$\\max_{\\pi_\\theta} \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r(x,y) - \\beta \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]$$\n\nè¿™æ ·ï¼Œæ¨¡å‹åœ¨æ¯ä¸€è½®è®­ç»ƒé‡‡æ ·æ—¶ï¼Œå°±å¯ä»¥åŒæ—¶ä¼˜åŒ–å¥–åŠ±å¹¶è®¡ç®— KL æƒ©ç½šã€‚\n\n\n\n**ä¸ºä»€ä¹ˆè¿™ä¸ªç›®æ ‡å‡½æ•°ä¸å¯å¯¼ï¼Ÿ**\n\nè¯­è¨€æ¨¡å‹æ˜¯**ç¦»æ•£ç”Ÿæˆ**çš„ï¼š\n\n+ è¾“å‡ºæ˜¯ token åºåˆ— $y = (y_1, y_2, \\ldots)$\n+ é‡‡æ · / argmax éƒ½æ˜¯ç¦»æ•£æ“ä½œ\n\næ— æ³•åƒæ™®é€šç›‘ç£å­¦ä¹ é‚£æ ·ï¼Œå¯¹ $\\mathbb{E}\\_{y \\sim \\pi\\_\\theta(y|x)}[r(x,y)]$ ç›´æ¥å¯¹ $\\theta$ æ±‚æ¢¯åº¦ã€‚\n\nğŸ‘‰ æ‰€ä»¥ä¸èƒ½ç”¨åå‘ä¼ æ’­ç›´æ¥ä¼˜åŒ–å¥–åŠ±  \nğŸ‘‰ å¿…é¡»ç”¨å¼ºåŒ–å­¦ä¹ ï¼ˆpolicy gradientï¼‰\n\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨ REINFORCE / PPOã€‚\n\n**KL çº¦æŸæ˜¯æ€ä¹ˆå˜æˆ\"å¥–åŠ±\"çš„ï¼Ÿ**\n\n\n\n**å…³é”®ä¸€æ­¥æ˜¯ï¼šæŠŠå…¬å¼ (3) KL é¡¹å†™æˆ log-prob çš„å½¢å¼**\n\nå¯¹ç¦»æ•£ç­–ç•¥ï¼š\n\n$$D_{\\text{KL}}(\\pi_\\theta \\| \\pi_{ref}) = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right]$$\n\n**ä»£å›ç›®æ ‡å‡½æ•°**ï¼š\n\n$$\\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right) \\right]$$\n\n**äºæ˜¯å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„ reward**ï¼š\n\n$$r(x, y) = r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)$$\n\nå³è®ºæ–‡ä¸­çš„ï¼š\n\n$$r(x, y) = r_\\phi(x, y) - \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)$$\n\nï¼ˆè®ºæ–‡é‡Œé€šå¸¸æŠŠ $\\beta$ çœç•¥æˆ–å¸æ”¶åˆ°ç³»æ•°é‡Œï¼‰\n\n**è½¬æ¢åçš„ç®€åŒ–ç›®æ ‡å‡½æ•°**\n\né€šè¿‡è¿™ä¸ªå˜æ¢ï¼ŒåŸæ¥çš„çº¦æŸä¼˜åŒ–é—®é¢˜å˜æˆäº†æ— çº¦æŸçš„å¥–åŠ±æœ€å¤§åŒ–é—®é¢˜ï¼š\n\n$$\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r(x, y) \\right]$$\n\nå…¶ä¸­ $r(x, y)$ å·²ç»åŒ…å«äº† KL æƒ©ç½šé¡¹ã€‚\n\n---\n","source":"_posts/RLHF çš„ä¸‰é˜¶æ®µæµç¨‹.md","raw":"---\ntitle: RLHF çš„ä¸‰é˜¶æ®µæµç¨‹\ndate: 2026-02-12\ntags: [LLM]\ncategories: [ç®—æ³•]\nexcerpt: æ·±å…¥ç†è§£ RLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰çš„ä¸‰ä¸ªæ ¸å¿ƒé˜¶æ®µ\n---\n\n## åŸºç¡€çŸ¥è¯†\n### RLHF çš„ä¸‰é˜¶æ®µæµç¨‹\nRLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰é€šå¸¸åŒ…å«ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š\n\n**ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰â†’ åå¥½é‡‡æ · + å¥–åŠ±æ¨¡å‹å­¦ä¹  â†’ å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼ˆRLï¼‰**\n\nç®€å•å¯ä»¥ç†è§£ä¸ºï¼šå…ˆå­¦\"æ€ä¹ˆè¯´è¯\"ï¼Œå†å­¦\"ä»€ä¹ˆè¯æ›´å¥½\"ï¼Œæœ€åé€¼æ¨¡å‹å¤šè¯´\"å¥½è¯\"\n\n#### é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised Fine-Tuningï¼‰\nRLHF é€šå¸¸ä»å¯¹ä¸€ä¸ªé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œç›‘ç£å¾®è°ƒå¼€å§‹ï¼Œä½¿ç”¨é«˜è´¨é‡çš„äººå·¥æ•°æ®ï¼ˆå¦‚å¯¹è¯ã€æ‘˜è¦ç­‰ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡å‹ $\\pi\\_{SFT}$ã€‚\n\n**æ•°æ®å½¢å¼**ï¼š$(\\text{prompt } x, \\text{é«˜è´¨é‡å›ç­” } y)$\n\n**æŸå¤±å‡½æ•°**ï¼šæ ‡å‡†çš„ç›‘ç£å­¦ä¹ æŸå¤±å‡½æ•°\n\n$$\\max_{\\theta} \\sum_{(x,y) \\in D} \\log \\pi_\\theta(y|x)$$\n\n+ $\\pi\\_\\theta$ï¼šç­–ç•¥æ¨¡å‹çš„å‚æ•°åŒ–å½¢å¼\n+ $D$ï¼šç›‘ç£å¾®è°ƒæ•°æ®é›†\n+ $x$ï¼šè¾“å…¥æç¤º\n+ $y$ï¼šç›®æ ‡å›ç­”\n\n**ç›®æ ‡**ï¼šè®©æ¨¡å‹å­¦ä¼šåŸºæœ¬çš„å¯¹è¯èƒ½åŠ›å’Œä»»åŠ¡å®Œæˆèƒ½åŠ›ï¼Œå³\"æ€ä¹ˆè¯´è¯\"\n\n#### é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward Modelingï¼‰\nä½¿ç”¨ SFT æ¨¡å‹ï¼Œå¯¹åŒä¸€ä¸ª prompt $x$ é‡‡æ ·ä¸¤ä¸ªå›ç­”ï¼š\n\n$$y_1, y_2 \\sim \\pi_{SFT}(y|x)$$\n\näº¤ç»™äººç±»æ ‡æ³¨è€…ï¼Œè®©ä»–ä»¬é€‰æ›´å¥½çš„ä¸€ä¸ªï¼š\n\n$$y_w \\succ y_l \\mid x$$\n\n+ $y_w$ï¼šwinner,preferredï¼ˆèµ¢å®¶ï¼‰\n+ $y_l$ï¼šloser,rejectedï¼ˆè¾“å®¶ï¼‰\n\n\n\n**æ½œåœ¨å¥–åŠ±å‡½æ•°å‡è®¾**ï¼šå‡è®¾äººç±»åå¥½æ˜¯ç”±ä¸€ä¸ªæœªçŸ¥çš„çœŸå®å¥–åŠ±å‡½æ•° $r^*(x,y)$ ç”Ÿæˆçš„ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒï¼Œä½†å‡è®¾å®ƒå­˜åœ¨ã€‚\n\n\n\n**åå¥½æ¨¡å‹**ï¼š\n\n$$p^*(y_1 > y_2 | x) = \\frac{\\exp(r^*(x, y_1))}{\\exp(r^*(x, y_1)) + \\exp(r^*(x, y_2))} \\tag{1}$$\n\n**æ•°æ®é›†å½¢å¼**ï¼š\n\n$$D = \\{(x^{(i)}, y_w^{(i)}, y_l^{(i)})\\}_{i=1}^N$$\n\n**æŸå¤±å‡½æ•°**ï¼š\n\n$$\\mathcal{L}_\\text{R}(r_\\phi, \\mathcal{D}) = -\\mathbb{E}_{(x, y_w, y_l) \\sim \\mathcal{D}} \\left[ \\log \\sigma (r_\\phi(x, y_w) - r_\\phi(x, y_l)) \\right] \\tag{2}$$\n\n---\n\n##### è¡¥å……è§£é‡Š\nBT æ¨¡å‹ï¼š\n\nBradley-Terry æ¨¡å‹æ˜¯ä¸€ä¸ªç”¨äº**æˆå¯¹æ¯”è¾ƒ**çš„æ¦‚ç‡æ¨¡å‹\n\n**æ ¸å¿ƒæ€æƒ³**ï¼š\n\n+ æ¯ä¸ªå¯¹è±¡ $i$ æœ‰ä¸€ä¸ªéšè—çš„\"å®åŠ›å€¼\"å‚æ•° $\\lambda_i$\n+ å½“ä¸¤ä¸ªå¯¹è±¡ $i$ å’Œ $j$ æ¯”è¾ƒæ—¶ï¼Œ$i$ æˆ˜èƒœ $j$ çš„æ¦‚ç‡ä¸ºï¼š\n\n$$P(i \\succ j) = \\frac{\\lambda_i}{\\lambda_i + \\lambda_j}$$\n\n**åœ¨ DPO ä¸­çš„åº”ç”¨**ï¼š\n\n+ å°†å¥–åŠ±å‡½æ•° $r(x,y)$ çœ‹ä½œ\"å®åŠ›å€¼\"\n+ äººç±»åå¥½ $ y_w \\succ y_l $ å°±æ˜¯\"æ¯”è¾ƒç»“æœ\"\n+ é€šè¿‡ BT æ¨¡å‹å»ºç«‹å¥–åŠ±ä¸åå¥½çš„æ¡¥æ¢\n\n\n\nä¸ºä»€ä¹ˆä¸ç”¨ã€Œè°åˆ†æ•°å¤§å°±é€‰è°ã€ï¼Ÿ\n\nå¦‚æœç›´æ¥è§„å®šï¼š$$y_1 \\succ y_2 \\iff r^*(x,y_1) > r^*(x,y_2)$$  \né‚£é—®é¢˜æ˜¯ï¼šäººç±»åˆ¤æ–­æœ‰å™ªå£°ï¼ŒåŒä¸€ä¸ªäººã€åŒä¸€ä¸ªé—®é¢˜ï¼Œä¸ä¸€å®šæ¯æ¬¡é€‰åŒæ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å»ºæ¨¡æˆç¡®å®šæ€§è§„åˆ™ï¼Œè€Œæ˜¯ï¼šæ¦‚ç‡æ¨¡å‹\n\næŠŠå…¬å¼ (1) æ”¹å†™ä¸€ä¸‹ï¼š\n\n$$p^*(y_1 \\succ y_2 \\mid x) = \\frac{1}{1 + e^{-(r^*(x,y_1) - r^*(x,y_2))}}$$\n\nè¿™å°±æ˜¯ç†Ÿæ‚‰çš„ Sigmoid å‡½æ•°ï¼š\n\n$$\\sigma(z) = \\frac{1}{1 + e^{-z}}$$\n\näºæ˜¯ï¼š\n\n$$p^*(y_1 \\succ y_2 \\mid x) = \\sigma(r^*(x,y_1) - r^*(x,y_2))$$\n\nå› ä¸ºçœŸå®æ•°æ®é‡Œäººç¡®å®é€‰æ‹©äº† $ y_w $ï¼Œæ‰€ä»¥è¯¥äº‹ä»¶çš„æ¦‚ç‡æ˜¯ä¸Šå¼ï¼Œå¯¹æ•°ä¼¼ç„¶æ˜¯ï¼š\n\n$$\\log p_\\theta(y_w \\succ y_l \\mid x) = \\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))$$\n\næœ€å¤§åŒ–æ‰€æœ‰æ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ï¼š\n\n$$\\max_\\theta \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))$$\n\næ„æ€æ˜¯ï¼šå¯¹æ¯ä¸€æ¡æ•°æ®ï¼Œéƒ½ç®—ä¸€æ¬¡\"æ¨¡å‹è®¤ä¸ºäººç±»ä¼šé€‰èµ¢å®¶çš„æ¦‚ç‡çš„å¯¹æ•°\"ï¼Œç„¶åæŠŠå®ƒä»¬åŠ èµ·æ¥ï¼Œè®©è¿™ä¸ªæ€»å’Œå°½å¯èƒ½å¤§ã€‚å¯¹æ•°æŠŠâ€œè¿ä¹˜â€å˜æˆâ€œè¿åŠ â€,æœ€ä¼˜è§£ä¸å˜(å¯¹æ•°æ˜¯å•è°ƒé€’å¢å‡½æ•°)\n\nç­‰ä»·åœ°ï¼Œæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆLikelihoodï¼‰ï¼š\n\n$$L_R = -\\mathbb{E}_{(x,y_w,y_l) \\sim D} [\\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))]$$\n\nè¿™æ­£æ˜¯å…¬å¼ (2)ã€‚æ„æ€æ˜¯ï¼šå¯¹æ•°æ®é›†é‡Œçš„æ ·æœ¬å–å¹³å‡ï¼Œç„¶åå¯¹\"å¯¹æ•°æ¦‚ç‡\"å–è´Ÿå·ï¼Œè®©è¿™ä¸ªå€¼å°½å¯èƒ½å°ã€‚\n\n\n\nå¯¹ä¸€ä¸ªæœ‰é™æ•°æ®é›† $D = \\{z_1, ..., z_N\\}$ï¼Œå¦‚æœä½ å‡åŒ€éšæœºä»ä¸­æŠ½ä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆï¼š\n\n$$\\mathbb{E}_{z \\sim D} [f(z)] = \\frac{1}{N} \\sum_{i=1}^N f(z_i)$$\n\nğŸ‘‰ æœŸæœ› = å¹³å‡å€¼\n\nä»¤ $f(x,y\\_w,y\\_l) = \\log \\sigma(r\\_\\theta(x,y\\_w) - r\\_\\theta(x,y\\_l))$ é‚£ä¹ˆï¼š\n\n$$\\mathbb{E}_{(x,y_w,y_l) \\sim D} [f] = \\frac{1}{N} \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))$$\n\nå› ä¸º $\\sum\\_{i=1}^N f\\_i$ å’Œ $\\frac{1}{N} \\sum\\_{i=1}^N f\\_i$ åªå·®ä¸€ä¸ªå¸¸æ•° $\\frac{1}{N}$ã€‚è€Œåœ¨ä¼˜åŒ–ä¸­ï¼šä¹˜ä»¥ä¸€ä¸ªæ­£çš„å¸¸æ•°ï¼Œä¸ä¼šæ”¹å˜æœ€ä¼˜è§£çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š$$\\arg\\max\\_\\theta \\sum\\_{i=1}^N f\\_i = \\arg\\max\\_\\theta \\frac{1}{N} \\sum\\_{i=1}^N f\\_i$$\n\nåŸç›®æ ‡ï¼š$$\\max_\\theta \\mathbb{E}_D [\\log \\sigma(\\cdots)]$$\n\nç­‰ä»·äºï¼š$$\\min_\\theta -\\mathbb{E}_D [\\log \\sigma(\\cdots)]$$\n\näºæ˜¯å®šä¹‰ï¼š$$L_R = -\\mathbb{E}_D [\\log \\sigma(\\cdots)]$$\n\n**ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ é‡Œ\"æ€»æ˜¯æœ€å°åŒ–\"ï¼Ÿ**\n\nå› ä¸ºæ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰é»˜è®¤æ˜¯ minimize lossï¼Œæ‰€ä»¥å¤§å®¶ä¹ æƒ¯ï¼šæŠŠ\"æƒ³æœ€å¤§åŒ–çš„ç›®æ ‡\"ï¼Œå†™æˆ\"è¦æœ€å°åŒ–çš„æŸå¤±\"ã€‚\n\n---\n\n#### é˜¶æ®µä¸‰ï¼šRL å¾®è°ƒ\n**RL ç›®æ ‡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰**ï¼š\n\n$$\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r_\\phi(x, y) - \\beta D_{\\text{KL}} \\left[ \\pi_\\theta(y|x) \\middle\\| \\pi_{\\text{ref}}(y|x) \\right] \\right] \\tag{3}$$\n\n---\n\n##### è¡¥å……è§£é‡Š\nä¸€å¥è¯è§£é‡Šï¼šğŸ‘‰ è®©æ¨¡å‹ç”Ÿæˆ å¥–åŠ±é«˜çš„å›ç­” ğŸ‘‰ ä½†ä¸èƒ½åç¦»åŸå§‹ SFT æ¨¡å‹å¤ªè¿œ\n\n\n\n$\\pi\\_{ref}$ï¼ˆå³åˆå§‹ SFT æ¨¡å‹ $\\pi\\_{SFT}$ï¼‰å®è·µä¸­ï¼Œè¯­è¨€æ¨¡å‹ç­–ç•¥ $\\pi\\_\\theta$ ä¹Ÿè¢«åˆå§‹åŒ–ä¸º $\\pi\\_{SFT}$ã€‚\n\n+ **åˆå§‹çŠ¶æ€**ï¼š$\\pi\\_\\theta = \\pi\\_{ref} = \\pi\\_{SFT}$\n+ **è®­ç»ƒç›®æ ‡**ï¼šåœ¨ä¿æŒä¸åŸå§‹ SFT æ¨¡å‹æ¥è¿‘çš„å‰æä¸‹ï¼Œä¼˜åŒ–å¥–åŠ±\n+ **KL çº¦æŸä½œç”¨**ï¼šç¡®ä¿æ¨¡å‹ä¸ä¼šåç¦»åˆå§‹èƒ½åŠ›å¤ªè¿œ\n\n**KL çº¦æŸï¼š**\n\nKL æ•£åº¦ï¼ˆKullback-Leibler æ•£åº¦ï¼‰è¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼š\n\n$$D_{\\text{KL}}[P \\| Q] = \\sum_x P(x) \\log \\frac{P(x)}{Q(x)}$$\n\n$$D_{\\text{KL}}[\\pi_\\theta(y|x) \\| \\pi_{SFT}(y|x)] = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]$$\n\nè¿™è¡¨ç¤ºï¼š\n\n+ å¦‚æœ $\\pi\\_\\theta$ å’Œ $\\pi\\_{SFT}$ ç›¸åŒï¼šKL = 0\n+ å¦‚æœ $\\pi\\_\\theta$ åç¦» $\\pi\\_{SFT}$ï¼šKL > 0\n+ ç›®æ ‡å‡½æ•°ä¸­çš„ $-\\beta KL$ æƒ©ç½šåç¦»è¡Œä¸º\n\n\n\n**KL æ•£åº¦æ¨å¯¼è¿‡ç¨‹è¯¦è§£**\n\n**KL æ•£åº¦çš„é€šç”¨å®šä¹‰ï¼ˆç¦»æ•£å‹ï¼‰**ï¼š\n\n$$D_{\\text{KL}}[P \\| Q] = \\sum_i P(i) \\log \\frac{P(i)}{Q(i)}$$\n\n**æœŸæœ›çš„å®šä¹‰**ï¼š  \nå¯¹äºéšæœºå˜é‡ $Y \\sim P$ï¼Œå‡½æ•° $f(Y)$ çš„æœŸæœ›å®šä¹‰ä¸ºï¼š\n\n$$\\mathbb{E}_{Y \\sim P}[f(Y)] = \\sum_{y \\in \\mathcal{Y}} P(y) f(y)$$\n\n**è¿›è¡Œå˜é‡æ˜ å°„**\n\nåœ¨ RLHF çš„è¯­å¢ƒä¸‹ï¼Œæˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯ä¸¤ä¸ªæ¨¡å‹ç­–ç•¥ï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰ä¹‹é—´çš„å·®å¼‚ï¼š\n\n+ $P$** (å½“å‰åˆ†å¸ƒ)**ï¼š$\\pi\\_\\theta(y|x)$ â€”â€” æ¨¡å‹å½“å‰æ­£åœ¨å­¦ä¹ çš„ç­–ç•¥\n+ $Q$** (å‚è€ƒåˆ†å¸ƒ)**ï¼š$\\pi\\_{SFT}(y|x)$ â€”â€” åŸå§‹çš„ SFT ç­–ç•¥\n+ **æ ·æœ¬ç©ºé—´**ï¼š$y$ï¼ˆæ¨¡å‹ç”Ÿæˆçš„æ‰€æœ‰å¯èƒ½çš„å›ç­”åºåˆ—ï¼‰\n\nå°†è¿™äº›ä»£å…¥é€šç”¨å…¬å¼ï¼š\n\n$$D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\sum_y \\pi_\\theta(y|x) \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)}$$\n\n**è½¬åŒ–ä¸ºæœŸæœ›å½¢å¼**\n\n+ å¤–å±‚çš„ $\\sum\\_y \\pi\\_\\theta(y|x)(\\cdots)$ è¡¨ç¤ºæˆ‘ä»¬åœ¨æŒ‰ç…§ $\\pi\\_\\theta(y|x)$ çš„æ¦‚ç‡åˆ†å¸ƒå¯¹åé¢çš„é¡¹è¿›è¡ŒåŠ æƒå¹³å‡\n+ æ‹¬å·é‡Œçš„é¡¹ $\\log \\frac{\\pi\\_\\theta(y|x)}{\\pi\\_{SFT}(y|x)}$ å°±æ˜¯è¦è®¡ç®—æœŸæœ›çš„å¯¹è±¡\n\nå› æ­¤ï¼Œæ ¹æ®æœŸæœ›çš„å®šä¹‰ $ \\sum P \\cdot f = \\mathbb{E}_P[f] $ï¼Œå¯ä»¥ç›´æ¥å†™æˆï¼š\n\n$$D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\mathbb{E}_{y \\sim \\pi_\\theta(y|x)} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]$$\n\n**ä¸ºä»€ä¹ˆå®è·µä¸­è¦å†™æˆæœŸæœ›å½¢å¼ï¼Ÿ**\n\nåœ¨æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ä¸­ï¼Œå†™æˆæœŸæœ›å½¢å¼æœ‰é‡å¤§çš„å·¥ç¨‹æ„ä¹‰ï¼š\n\n**æ— æ³•å…¨é‡æ±‚å’Œ**ï¼š  \nå¯¹äºè¯­è¨€æ¨¡å‹ï¼Œå¯èƒ½çš„å›ç­” $y$ çš„ç»„åˆæ˜¯å¤©æ–‡æ•°å­—ï¼ˆç”±è¯è¡¨å¤§å°å’Œåºåˆ—é•¿åº¦å†³å®šï¼‰ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•éå†æ‰€æœ‰çš„ $y$ æ¥è®¡ç®—é‚£ä¸ª $\\sum$ ç¬¦å·ã€‚\n\n**è’™ç‰¹å¡æ´›é‡‡æ ·ï¼ˆMonte Carlo Samplingï¼‰**ï¼š  \næœŸæœ›å½¢å¼å‘Šè¯‰æˆ‘ä»¬ï¼Œè™½ç„¶ä¸èƒ½éå†æ‰€æœ‰ç»“æœï¼Œä½†å¯ä»¥é€šè¿‡é‡‡æ ·æ¥è¿‘ä¼¼ï¼šè®©æ¨¡å‹ $\\pi\\_\\theta$ ç”Ÿæˆï¼ˆSampleï¼‰ä¸€æ‰¹å¥å­ $y$,è®¡ç®—è¿™äº›å¥å­çš„ $\\log \\pi\\_\\theta(y|x) - \\log \\pi\\_{SFT}(y|x)$,å–è¿™äº›å€¼çš„å¹³å‡å€¼ï¼Œå°±æ˜¯å¯¹ KL æ•£åº¦çš„æ— åä¼°è®¡\n\n**å¯¹é½ç›®æ ‡å‡½æ•°**ï¼š  \nRL çš„ç›®æ ‡å‡½æ•°æœ¬èº«å°±æ˜¯æœ€å¤§åŒ–æœŸæœ›å¥–åŠ± $\\mathbb{E}\\_{y \\sim \\pi\\_\\theta}[r(x,y)]$ã€‚å°† KL çº¦æŸä¹Ÿå†™æˆæœŸæœ›å½¢å¼ï¼Œå°±å¯ä»¥åˆå¹¶åˆ°ä¸€ä¸ªå¤§æ‹¬å·é‡Œï¼š\n\n$$\\max_{\\pi_\\theta} \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r(x,y) - \\beta \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]$$\n\nè¿™æ ·ï¼Œæ¨¡å‹åœ¨æ¯ä¸€è½®è®­ç»ƒé‡‡æ ·æ—¶ï¼Œå°±å¯ä»¥åŒæ—¶ä¼˜åŒ–å¥–åŠ±å¹¶è®¡ç®— KL æƒ©ç½šã€‚\n\n\n\n**ä¸ºä»€ä¹ˆè¿™ä¸ªç›®æ ‡å‡½æ•°ä¸å¯å¯¼ï¼Ÿ**\n\nè¯­è¨€æ¨¡å‹æ˜¯**ç¦»æ•£ç”Ÿæˆ**çš„ï¼š\n\n+ è¾“å‡ºæ˜¯ token åºåˆ— $y = (y_1, y_2, \\ldots)$\n+ é‡‡æ · / argmax éƒ½æ˜¯ç¦»æ•£æ“ä½œ\n\næ— æ³•åƒæ™®é€šç›‘ç£å­¦ä¹ é‚£æ ·ï¼Œå¯¹ $\\mathbb{E}\\_{y \\sim \\pi\\_\\theta(y|x)}[r(x,y)]$ ç›´æ¥å¯¹ $\\theta$ æ±‚æ¢¯åº¦ã€‚\n\nğŸ‘‰ æ‰€ä»¥ä¸èƒ½ç”¨åå‘ä¼ æ’­ç›´æ¥ä¼˜åŒ–å¥–åŠ±  \nğŸ‘‰ å¿…é¡»ç”¨å¼ºåŒ–å­¦ä¹ ï¼ˆpolicy gradientï¼‰\n\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨ REINFORCE / PPOã€‚\n\n**KL çº¦æŸæ˜¯æ€ä¹ˆå˜æˆ\"å¥–åŠ±\"çš„ï¼Ÿ**\n\n\n\n**å…³é”®ä¸€æ­¥æ˜¯ï¼šæŠŠå…¬å¼ (3) KL é¡¹å†™æˆ log-prob çš„å½¢å¼**\n\nå¯¹ç¦»æ•£ç­–ç•¥ï¼š\n\n$$D_{\\text{KL}}(\\pi_\\theta \\| \\pi_{ref}) = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right]$$\n\n**ä»£å›ç›®æ ‡å‡½æ•°**ï¼š\n\n$$\\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right) \\right]$$\n\n**äºæ˜¯å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„ reward**ï¼š\n\n$$r(x, y) = r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)$$\n\nå³è®ºæ–‡ä¸­çš„ï¼š\n\n$$r(x, y) = r_\\phi(x, y) - \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)$$\n\nï¼ˆè®ºæ–‡é‡Œé€šå¸¸æŠŠ $\\beta$ çœç•¥æˆ–å¸æ”¶åˆ°ç³»æ•°é‡Œï¼‰\n\n**è½¬æ¢åçš„ç®€åŒ–ç›®æ ‡å‡½æ•°**\n\né€šè¿‡è¿™ä¸ªå˜æ¢ï¼ŒåŸæ¥çš„çº¦æŸä¼˜åŒ–é—®é¢˜å˜æˆäº†æ— çº¦æŸçš„å¥–åŠ±æœ€å¤§åŒ–é—®é¢˜ï¼š\n\n$$\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r(x, y) \\right]$$\n\nå…¶ä¸­ $r(x, y)$ å·²ç»åŒ…å«äº† KL æƒ©ç½šé¡¹ã€‚\n\n---\n","slug":"RLHF çš„ä¸‰é˜¶æ®µæµç¨‹","published":1,"updated":"2026-02-12T11:43:20.995Z","_id":"cmlje1itt000180zkf7x02dj4","comments":1,"layout":"post","photos":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"åŸºç¡€çŸ¥è¯†\"><a href=\"#åŸºç¡€çŸ¥è¯†\" class=\"headerlink\" title=\"åŸºç¡€çŸ¥è¯†\"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id=\"RLHF-çš„ä¸‰é˜¶æ®µæµç¨‹\"><a href=\"#RLHF-çš„ä¸‰é˜¶æ®µæµç¨‹\" class=\"headerlink\" title=\"RLHF çš„ä¸‰é˜¶æ®µæµç¨‹\"></a>RLHF çš„ä¸‰é˜¶æ®µæµç¨‹</h3><p>RLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰é€šå¸¸åŒ…å«ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š</p>\n<p><strong>ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰â†’ åå¥½é‡‡æ · + å¥–åŠ±æ¨¡å‹å­¦ä¹  â†’ å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼ˆRLï¼‰</strong></p>\n<p>ç®€å•å¯ä»¥ç†è§£ä¸ºï¼šå…ˆå­¦â€æ€ä¹ˆè¯´è¯â€ï¼Œå†å­¦â€ä»€ä¹ˆè¯æ›´å¥½â€ï¼Œæœ€åé€¼æ¨¡å‹å¤šè¯´â€å¥½è¯â€</p>\n<h4 id=\"é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised-Fine-Tuningï¼‰\"><a href=\"#é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised-Fine-Tuningï¼‰\" class=\"headerlink\" title=\"é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised Fine-Tuningï¼‰\"></a>é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised Fine-Tuningï¼‰</h4><p>RLHF é€šå¸¸ä»å¯¹ä¸€ä¸ªé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œç›‘ç£å¾®è°ƒå¼€å§‹ï¼Œä½¿ç”¨é«˜è´¨é‡çš„äººå·¥æ•°æ®ï¼ˆå¦‚å¯¹è¯ã€æ‘˜è¦ç­‰ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡å‹ $\\pi_{SFT}$ã€‚</p>\n<p><strong>æ•°æ®å½¢å¼</strong>ï¼š$(\\text{prompt } x, \\text{é«˜è´¨é‡å›ç­” } y)$</p>\n<p><strong>æŸå¤±å‡½æ•°</strong>ï¼šæ ‡å‡†çš„ç›‘ç£å­¦ä¹ æŸå¤±å‡½æ•°</p>\n<script type=\"math/tex; mode=display\">\\max_{\\theta} \\sum_{(x,y) \\in D} \\log \\pi_\\theta(y|x)</script><ul>\n<li>$\\pi_\\theta$ï¼šç­–ç•¥æ¨¡å‹çš„å‚æ•°åŒ–å½¢å¼</li>\n<li>$D$ï¼šç›‘ç£å¾®è°ƒæ•°æ®é›†</li>\n<li>$x$ï¼šè¾“å…¥æç¤º</li>\n<li>$y$ï¼šç›®æ ‡å›ç­”</li>\n</ul>\n<p><strong>ç›®æ ‡</strong>ï¼šè®©æ¨¡å‹å­¦ä¼šåŸºæœ¬çš„å¯¹è¯èƒ½åŠ›å’Œä»»åŠ¡å®Œæˆèƒ½åŠ›ï¼Œå³â€æ€ä¹ˆè¯´è¯â€</p>\n<h4 id=\"é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward-Modelingï¼‰\"><a href=\"#é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward-Modelingï¼‰\" class=\"headerlink\" title=\"é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward Modelingï¼‰\"></a>é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward Modelingï¼‰</h4><p>ä½¿ç”¨ SFT æ¨¡å‹ï¼Œå¯¹åŒä¸€ä¸ª prompt $x$ é‡‡æ ·ä¸¤ä¸ªå›ç­”ï¼š</p>\n<script type=\"math/tex; mode=display\">y_1, y_2 \\sim \\pi_{SFT}(y|x)</script><p>äº¤ç»™äººç±»æ ‡æ³¨è€…ï¼Œè®©ä»–ä»¬é€‰æ›´å¥½çš„ä¸€ä¸ªï¼š</p>\n<script type=\"math/tex; mode=display\">y_w \\succ y_l \\mid x</script><ul>\n<li>$y_w$ï¼šwinner,preferredï¼ˆèµ¢å®¶ï¼‰</li>\n<li>$y_l$ï¼šloser,rejectedï¼ˆè¾“å®¶ï¼‰</li>\n</ul>\n<p><strong>æ½œåœ¨å¥–åŠ±å‡½æ•°å‡è®¾</strong>ï¼šå‡è®¾äººç±»åå¥½æ˜¯ç”±ä¸€ä¸ªæœªçŸ¥çš„çœŸå®å¥–åŠ±å‡½æ•° $r^*(x,y)$ ç”Ÿæˆçš„ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒï¼Œä½†å‡è®¾å®ƒå­˜åœ¨ã€‚</p>\n<p><strong>åå¥½æ¨¡å‹</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">p^*(y_1 > y_2 | x) = \\frac{\\exp(r^*(x, y_1))}{\\exp(r^*(x, y_1)) + \\exp(r^*(x, y_2))} \\tag{1}</script><p><strong>æ•°æ®é›†å½¢å¼</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">D = \\{(x^{(i)}, y_w^{(i)}, y_l^{(i)})\\}_{i=1}^N</script><p><strong>æŸå¤±å‡½æ•°</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathcal{L}_\\text{R}(r_\\phi, \\mathcal{D}) = -\\mathbb{E}_{(x, y_w, y_l) \\sim \\mathcal{D}} \\left[ \\log \\sigma (r_\\phi(x, y_w) - r_\\phi(x, y_l)) \\right] \\tag{2}</script><hr>\n<h5 id=\"è¡¥å……è§£é‡Š\"><a href=\"#è¡¥å……è§£é‡Š\" class=\"headerlink\" title=\"è¡¥å……è§£é‡Š\"></a>è¡¥å……è§£é‡Š</h5><p>BT æ¨¡å‹ï¼š</p>\n<p>Bradley-Terry æ¨¡å‹æ˜¯ä¸€ä¸ªç”¨äº<strong>æˆå¯¹æ¯”è¾ƒ</strong>çš„æ¦‚ç‡æ¨¡å‹</p>\n<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>\n<ul>\n<li>æ¯ä¸ªå¯¹è±¡ $i$ æœ‰ä¸€ä¸ªéšè—çš„â€å®åŠ›å€¼â€å‚æ•° $\\lambda_i$</li>\n<li>å½“ä¸¤ä¸ªå¯¹è±¡ $i$ å’Œ $j$ æ¯”è¾ƒæ—¶ï¼Œ$i$ æˆ˜èƒœ $j$ çš„æ¦‚ç‡ä¸ºï¼š</li>\n</ul>\n<script type=\"math/tex; mode=display\">P(i \\succ j) = \\frac{\\lambda_i}{\\lambda_i + \\lambda_j}</script><p><strong>åœ¨ DPO ä¸­çš„åº”ç”¨</strong>ï¼š</p>\n<ul>\n<li>å°†å¥–åŠ±å‡½æ•° $r(x,y)$ çœ‹ä½œâ€å®åŠ›å€¼â€</li>\n<li>äººç±»åå¥½ $ y_w \\succ y_l $ å°±æ˜¯â€æ¯”è¾ƒç»“æœâ€</li>\n<li>é€šè¿‡ BT æ¨¡å‹å»ºç«‹å¥–åŠ±ä¸åå¥½çš„æ¡¥æ¢</li>\n</ul>\n<p>ä¸ºä»€ä¹ˆä¸ç”¨ã€Œè°åˆ†æ•°å¤§å°±é€‰è°ã€ï¼Ÿ</p>\n<p>å¦‚æœç›´æ¥è§„å®šï¼š<script type=\"math/tex\">y_1 \\succ y_2 \\iff r^*(x,y_1) > r^*(x,y_2)</script><br>é‚£é—®é¢˜æ˜¯ï¼šäººç±»åˆ¤æ–­æœ‰å™ªå£°ï¼ŒåŒä¸€ä¸ªäººã€åŒä¸€ä¸ªé—®é¢˜ï¼Œä¸ä¸€å®šæ¯æ¬¡é€‰åŒæ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å»ºæ¨¡æˆç¡®å®šæ€§è§„åˆ™ï¼Œè€Œæ˜¯ï¼šæ¦‚ç‡æ¨¡å‹</p>\n<p>æŠŠå…¬å¼ (1) æ”¹å†™ä¸€ä¸‹ï¼š</p>\n<script type=\"math/tex; mode=display\">p^*(y_1 \\succ y_2 \\mid x) = \\frac{1}{1 + e^{-(r^*(x,y_1) - r^*(x,y_2))}}</script><p>è¿™å°±æ˜¯ç†Ÿæ‚‰çš„ Sigmoid å‡½æ•°ï¼š</p>\n<script type=\"math/tex; mode=display\">\\sigma(z) = \\frac{1}{1 + e^{-z}}</script><p>äºæ˜¯ï¼š</p>\n<script type=\"math/tex; mode=display\">p^*(y_1 \\succ y_2 \\mid x) = \\sigma(r^*(x,y_1) - r^*(x,y_2))</script><p>å› ä¸ºçœŸå®æ•°æ®é‡Œäººç¡®å®é€‰æ‹©äº† $ y_w $ï¼Œæ‰€ä»¥è¯¥äº‹ä»¶çš„æ¦‚ç‡æ˜¯ä¸Šå¼ï¼Œå¯¹æ•°ä¼¼ç„¶æ˜¯ï¼š</p>\n<script type=\"math/tex; mode=display\">\\log p_\\theta(y_w \\succ y_l \\mid x) = \\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))</script><p>æœ€å¤§åŒ–æ‰€æœ‰æ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_\\theta \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))</script><p>æ„æ€æ˜¯ï¼šå¯¹æ¯ä¸€æ¡æ•°æ®ï¼Œéƒ½ç®—ä¸€æ¬¡â€æ¨¡å‹è®¤ä¸ºäººç±»ä¼šé€‰èµ¢å®¶çš„æ¦‚ç‡çš„å¯¹æ•°â€ï¼Œç„¶åæŠŠå®ƒä»¬åŠ èµ·æ¥ï¼Œè®©è¿™ä¸ªæ€»å’Œå°½å¯èƒ½å¤§ã€‚å¯¹æ•°æŠŠâ€œè¿ä¹˜â€å˜æˆâ€œè¿åŠ â€,æœ€ä¼˜è§£ä¸å˜(å¯¹æ•°æ˜¯å•è°ƒé€’å¢å‡½æ•°)</p>\n<p>ç­‰ä»·åœ°ï¼Œæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆLikelihoodï¼‰ï¼š</p>\n<script type=\"math/tex; mode=display\">L_R = -\\mathbb{E}_{(x,y_w,y_l) \\sim D} [\\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))]</script><p>è¿™æ­£æ˜¯å…¬å¼ (2)ã€‚æ„æ€æ˜¯ï¼šå¯¹æ•°æ®é›†é‡Œçš„æ ·æœ¬å–å¹³å‡ï¼Œç„¶åå¯¹â€å¯¹æ•°æ¦‚ç‡â€å–è´Ÿå·ï¼Œè®©è¿™ä¸ªå€¼å°½å¯èƒ½å°ã€‚</p>\n<p>å¯¹ä¸€ä¸ªæœ‰é™æ•°æ®é›† $D = {z_1, â€¦, z_N}$ï¼Œå¦‚æœä½ å‡åŒ€éšæœºä»ä¸­æŠ½ä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{z \\sim D} [f(z)] = \\frac{1}{N} \\sum_{i=1}^N f(z_i)</script><p>ğŸ‘‰ æœŸæœ› = å¹³å‡å€¼</p>\n<p>ä»¤ $f(x,y_w,y_l) = \\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))$ é‚£ä¹ˆï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{(x,y_w,y_l) \\sim D} [f] = \\frac{1}{N} \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))</script><p>å› ä¸º $\\sum_{i=1}^N f_i$ å’Œ $\\frac{1}{N} \\sum_{i=1}^N f_i$ åªå·®ä¸€ä¸ªå¸¸æ•° $\\frac{1}{N}$ã€‚è€Œåœ¨ä¼˜åŒ–ä¸­ï¼šä¹˜ä»¥ä¸€ä¸ªæ­£çš„å¸¸æ•°ï¼Œä¸ä¼šæ”¹å˜æœ€ä¼˜è§£çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š<script type=\"math/tex\">\\arg\\max\\_\\theta \\sum\\_{i=1}^N f\\_i = \\arg\\max\\_\\theta \\frac{1}{N} \\sum\\_{i=1}^N f\\_i</script></p>\n<p>åŸç›®æ ‡ï¼š<script type=\"math/tex\">\\max_\\theta \\mathbb{E}_D [\\log \\sigma(\\cdots)]</script></p>\n<p>ç­‰ä»·äºï¼š<script type=\"math/tex\">\\min_\\theta -\\mathbb{E}_D [\\log \\sigma(\\cdots)]</script></p>\n<p>äºæ˜¯å®šä¹‰ï¼š<script type=\"math/tex\">L_R = -\\mathbb{E}_D [\\log \\sigma(\\cdots)]</script></p>\n<p><strong>ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ é‡Œâ€æ€»æ˜¯æœ€å°åŒ–â€ï¼Ÿ</strong></p>\n<p>å› ä¸ºæ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰é»˜è®¤æ˜¯ minimize lossï¼Œæ‰€ä»¥å¤§å®¶ä¹ æƒ¯ï¼šæŠŠâ€æƒ³æœ€å¤§åŒ–çš„ç›®æ ‡â€ï¼Œå†™æˆâ€è¦æœ€å°åŒ–çš„æŸå¤±â€ã€‚</p>\n<hr>\n<h4 id=\"é˜¶æ®µä¸‰ï¼šRL-å¾®è°ƒ\"><a href=\"#é˜¶æ®µä¸‰ï¼šRL-å¾®è°ƒ\" class=\"headerlink\" title=\"é˜¶æ®µä¸‰ï¼šRL å¾®è°ƒ\"></a>é˜¶æ®µä¸‰ï¼šRL å¾®è°ƒ</h4><p><strong>RL ç›®æ ‡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r_\\phi(x, y) - \\beta D_{\\text{KL}} \\left[ \\pi_\\theta(y|x) \\middle\\| \\pi_{\\text{ref}}(y|x) \\right] \\right] \\tag{3}</script><hr>\n<h5 id=\"è¡¥å……è§£é‡Š-1\"><a href=\"#è¡¥å……è§£é‡Š-1\" class=\"headerlink\" title=\"è¡¥å……è§£é‡Š\"></a>è¡¥å……è§£é‡Š</h5><p>ä¸€å¥è¯è§£é‡Šï¼šğŸ‘‰ è®©æ¨¡å‹ç”Ÿæˆ å¥–åŠ±é«˜çš„å›ç­” ğŸ‘‰ ä½†ä¸èƒ½åç¦»åŸå§‹ SFT æ¨¡å‹å¤ªè¿œ</p>\n<p>$\\pi_{ref}$ï¼ˆå³åˆå§‹ SFT æ¨¡å‹ $\\pi_{SFT}$ï¼‰å®è·µä¸­ï¼Œè¯­è¨€æ¨¡å‹ç­–ç•¥ $\\pi_\\theta$ ä¹Ÿè¢«åˆå§‹åŒ–ä¸º $\\pi_{SFT}$ã€‚</p>\n<ul>\n<li><strong>åˆå§‹çŠ¶æ€</strong>ï¼š$\\pi_\\theta = \\pi_{ref} = \\pi_{SFT}$</li>\n<li><strong>è®­ç»ƒç›®æ ‡</strong>ï¼šåœ¨ä¿æŒä¸åŸå§‹ SFT æ¨¡å‹æ¥è¿‘çš„å‰æä¸‹ï¼Œä¼˜åŒ–å¥–åŠ±</li>\n<li><strong>KL çº¦æŸä½œç”¨</strong>ï¼šç¡®ä¿æ¨¡å‹ä¸ä¼šåç¦»åˆå§‹èƒ½åŠ›å¤ªè¿œ</li>\n</ul>\n<p><strong>KL çº¦æŸï¼š</strong></p>\n<p>KL æ•£åº¦ï¼ˆKullback-Leibler æ•£åº¦ï¼‰è¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[P \\| Q] = \\sum_x P(x) \\log \\frac{P(x)}{Q(x)}</script><script type=\"math/tex; mode=display\">D_{\\text{KL}}[\\pi_\\theta(y|x) \\| \\pi_{SFT}(y|x)] = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]</script><p>è¿™è¡¨ç¤ºï¼š</p>\n<ul>\n<li>å¦‚æœ $\\pi_\\theta$ å’Œ $\\pi_{SFT}$ ç›¸åŒï¼šKL = 0</li>\n<li>å¦‚æœ $\\pi_\\theta$ åç¦» $\\pi_{SFT}$ï¼šKL &gt; 0</li>\n<li>ç›®æ ‡å‡½æ•°ä¸­çš„ $-\\beta KL$ æƒ©ç½šåç¦»è¡Œä¸º</li>\n</ul>\n<p><strong>KL æ•£åº¦æ¨å¯¼è¿‡ç¨‹è¯¦è§£</strong></p>\n<p><strong>KL æ•£åº¦çš„é€šç”¨å®šä¹‰ï¼ˆç¦»æ•£å‹ï¼‰</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[P \\| Q] = \\sum_i P(i) \\log \\frac{P(i)}{Q(i)}</script><p><strong>æœŸæœ›çš„å®šä¹‰</strong>ï¼š<br>å¯¹äºéšæœºå˜é‡ $Y \\sim P$ï¼Œå‡½æ•° $f(Y)$ çš„æœŸæœ›å®šä¹‰ä¸ºï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{Y \\sim P}[f(Y)] = \\sum_{y \\in \\mathcal{Y}} P(y) f(y)</script><p><strong>è¿›è¡Œå˜é‡æ˜ å°„</strong></p>\n<p>åœ¨ RLHF çš„è¯­å¢ƒä¸‹ï¼Œæˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯ä¸¤ä¸ªæ¨¡å‹ç­–ç•¥ï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰ä¹‹é—´çš„å·®å¼‚ï¼š</p>\n<ul>\n<li>$P$<strong> (å½“å‰åˆ†å¸ƒ)</strong>ï¼š$\\pi_\\theta(y|x)$ â€”â€” æ¨¡å‹å½“å‰æ­£åœ¨å­¦ä¹ çš„ç­–ç•¥</li>\n<li>$Q$<strong> (å‚è€ƒåˆ†å¸ƒ)</strong>ï¼š$\\pi_{SFT}(y|x)$ â€”â€” åŸå§‹çš„ SFT ç­–ç•¥</li>\n<li><strong>æ ·æœ¬ç©ºé—´</strong>ï¼š$y$ï¼ˆæ¨¡å‹ç”Ÿæˆçš„æ‰€æœ‰å¯èƒ½çš„å›ç­”åºåˆ—ï¼‰</li>\n</ul>\n<p>å°†è¿™äº›ä»£å…¥é€šç”¨å…¬å¼ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\sum_y \\pi_\\theta(y|x) \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)}</script><p><strong>è½¬åŒ–ä¸ºæœŸæœ›å½¢å¼</strong></p>\n<ul>\n<li>å¤–å±‚çš„ $\\sum_y \\pi_\\theta(y|x)(\\cdots)$ è¡¨ç¤ºæˆ‘ä»¬åœ¨æŒ‰ç…§ $\\pi_\\theta(y|x)$ çš„æ¦‚ç‡åˆ†å¸ƒå¯¹åé¢çš„é¡¹è¿›è¡ŒåŠ æƒå¹³å‡</li>\n<li>æ‹¬å·é‡Œçš„é¡¹ $\\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)}$ å°±æ˜¯è¦è®¡ç®—æœŸæœ›çš„å¯¹è±¡</li>\n</ul>\n<p>å› æ­¤ï¼Œæ ¹æ®æœŸæœ›çš„å®šä¹‰ $ \\sum P \\cdot f = \\mathbb{E}_P[f] $ï¼Œå¯ä»¥ç›´æ¥å†™æˆï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\mathbb{E}_{y \\sim \\pi_\\theta(y|x)} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]</script><p><strong>ä¸ºä»€ä¹ˆå®è·µä¸­è¦å†™æˆæœŸæœ›å½¢å¼ï¼Ÿ</strong></p>\n<p>åœ¨æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ä¸­ï¼Œå†™æˆæœŸæœ›å½¢å¼æœ‰é‡å¤§çš„å·¥ç¨‹æ„ä¹‰ï¼š</p>\n<p><strong>æ— æ³•å…¨é‡æ±‚å’Œ</strong>ï¼š<br>å¯¹äºè¯­è¨€æ¨¡å‹ï¼Œå¯èƒ½çš„å›ç­” $y$ çš„ç»„åˆæ˜¯å¤©æ–‡æ•°å­—ï¼ˆç”±è¯è¡¨å¤§å°å’Œåºåˆ—é•¿åº¦å†³å®šï¼‰ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•éå†æ‰€æœ‰çš„ $y$ æ¥è®¡ç®—é‚£ä¸ª $\\sum$ ç¬¦å·ã€‚</p>\n<p><strong>è’™ç‰¹å¡æ´›é‡‡æ ·ï¼ˆMonte Carlo Samplingï¼‰</strong>ï¼š<br>æœŸæœ›å½¢å¼å‘Šè¯‰æˆ‘ä»¬ï¼Œè™½ç„¶ä¸èƒ½éå†æ‰€æœ‰ç»“æœï¼Œä½†å¯ä»¥é€šè¿‡é‡‡æ ·æ¥è¿‘ä¼¼ï¼šè®©æ¨¡å‹ $\\pi_\\theta$ ç”Ÿæˆï¼ˆSampleï¼‰ä¸€æ‰¹å¥å­ $y$,è®¡ç®—è¿™äº›å¥å­çš„ $\\log \\pi_\\theta(y|x) - \\log \\pi_{SFT}(y|x)$,å–è¿™äº›å€¼çš„å¹³å‡å€¼ï¼Œå°±æ˜¯å¯¹ KL æ•£åº¦çš„æ— åä¼°è®¡</p>\n<p><strong>å¯¹é½ç›®æ ‡å‡½æ•°</strong>ï¼š<br>RL çš„ç›®æ ‡å‡½æ•°æœ¬èº«å°±æ˜¯æœ€å¤§åŒ–æœŸæœ›å¥–åŠ± $\\mathbb{E}_{y \\sim \\pi_\\theta}[r(x,y)]$ã€‚å°† KL çº¦æŸä¹Ÿå†™æˆæœŸæœ›å½¢å¼ï¼Œå°±å¯ä»¥åˆå¹¶åˆ°ä¸€ä¸ªå¤§æ‹¬å·é‡Œï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_{\\pi_\\theta} \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r(x,y) - \\beta \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]</script><p>è¿™æ ·ï¼Œæ¨¡å‹åœ¨æ¯ä¸€è½®è®­ç»ƒé‡‡æ ·æ—¶ï¼Œå°±å¯ä»¥åŒæ—¶ä¼˜åŒ–å¥–åŠ±å¹¶è®¡ç®— KL æƒ©ç½šã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆè¿™ä¸ªç›®æ ‡å‡½æ•°ä¸å¯å¯¼ï¼Ÿ</strong></p>\n<p>è¯­è¨€æ¨¡å‹æ˜¯<strong>ç¦»æ•£ç”Ÿæˆ</strong>çš„ï¼š</p>\n<ul>\n<li>è¾“å‡ºæ˜¯ token åºåˆ— $y = (y_1, y_2, \\ldots)$</li>\n<li>é‡‡æ · / argmax éƒ½æ˜¯ç¦»æ•£æ“ä½œ</li>\n</ul>\n<p>æ— æ³•åƒæ™®é€šç›‘ç£å­¦ä¹ é‚£æ ·ï¼Œå¯¹ $\\mathbb{E}_{y \\sim \\pi_\\theta(y|x)}[r(x,y)]$ ç›´æ¥å¯¹ $\\theta$ æ±‚æ¢¯åº¦ã€‚</p>\n<p>ğŸ‘‰ æ‰€ä»¥ä¸èƒ½ç”¨åå‘ä¼ æ’­ç›´æ¥ä¼˜åŒ–å¥–åŠ±<br>ğŸ‘‰ å¿…é¡»ç”¨å¼ºåŒ–å­¦ä¹ ï¼ˆpolicy gradientï¼‰</p>\n<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨ REINFORCE / PPOã€‚</p>\n<p><strong>KL çº¦æŸæ˜¯æ€ä¹ˆå˜æˆâ€å¥–åŠ±â€çš„ï¼Ÿ</strong></p>\n<p><strong>å…³é”®ä¸€æ­¥æ˜¯ï¼šæŠŠå…¬å¼ (3) KL é¡¹å†™æˆ log-prob çš„å½¢å¼</strong></p>\n<p>å¯¹ç¦»æ•£ç­–ç•¥ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}(\\pi_\\theta \\| \\pi_{ref}) = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right]</script><p><strong>ä»£å›ç›®æ ‡å‡½æ•°</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right) \\right]</script><p><strong>äºæ˜¯å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„ reward</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">r(x, y) = r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)</script><p>å³è®ºæ–‡ä¸­çš„ï¼š</p>\n<script type=\"math/tex; mode=display\">r(x, y) = r_\\phi(x, y) - \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)</script><p>ï¼ˆè®ºæ–‡é‡Œé€šå¸¸æŠŠ $\\beta$ çœç•¥æˆ–å¸æ”¶åˆ°ç³»æ•°é‡Œï¼‰</p>\n<p><strong>è½¬æ¢åçš„ç®€åŒ–ç›®æ ‡å‡½æ•°</strong></p>\n<p>é€šè¿‡è¿™ä¸ªå˜æ¢ï¼ŒåŸæ¥çš„çº¦æŸä¼˜åŒ–é—®é¢˜å˜æˆäº†æ— çº¦æŸçš„å¥–åŠ±æœ€å¤§åŒ–é—®é¢˜ï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r(x, y) \\right]</script><p>å…¶ä¸­ $r(x, y)$ å·²ç»åŒ…å«äº† KL æƒ©ç½šé¡¹ã€‚</p>\n<hr>\n","more":"<h2 id=\"åŸºç¡€çŸ¥è¯†\"><a href=\"#åŸºç¡€çŸ¥è¯†\" class=\"headerlink\" title=\"åŸºç¡€çŸ¥è¯†\"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id=\"RLHF-çš„ä¸‰é˜¶æ®µæµç¨‹\"><a href=\"#RLHF-çš„ä¸‰é˜¶æ®µæµç¨‹\" class=\"headerlink\" title=\"RLHF çš„ä¸‰é˜¶æ®µæµç¨‹\"></a>RLHF çš„ä¸‰é˜¶æ®µæµç¨‹</h3><p>RLHFï¼ˆReinforcement Learning from Human Feedbackï¼‰é€šå¸¸åŒ…å«ä¸‰ä¸ªä¸»è¦é˜¶æ®µï¼š</p>\n<p><strong>ç›‘ç£å¾®è°ƒï¼ˆSFTï¼‰â†’ åå¥½é‡‡æ · + å¥–åŠ±æ¨¡å‹å­¦ä¹  â†’ å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–ï¼ˆRLï¼‰</strong></p>\n<p>ç®€å•å¯ä»¥ç†è§£ä¸ºï¼šå…ˆå­¦â€æ€ä¹ˆè¯´è¯â€ï¼Œå†å­¦â€ä»€ä¹ˆè¯æ›´å¥½â€ï¼Œæœ€åé€¼æ¨¡å‹å¤šè¯´â€å¥½è¯â€</p>\n<h4 id=\"é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised-Fine-Tuningï¼‰\"><a href=\"#é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised-Fine-Tuningï¼‰\" class=\"headerlink\" title=\"é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised Fine-Tuningï¼‰\"></a>é˜¶æ®µä¸€ï¼šSFTï¼ˆSupervised Fine-Tuningï¼‰</h4><p>RLHF é€šå¸¸ä»å¯¹ä¸€ä¸ªé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œç›‘ç£å¾®è°ƒå¼€å§‹ï¼Œä½¿ç”¨é«˜è´¨é‡çš„äººå·¥æ•°æ®ï¼ˆå¦‚å¯¹è¯ã€æ‘˜è¦ç­‰ï¼‰ï¼Œå¾—åˆ°ä¸€ä¸ªæ¨¡å‹ $\\pi_{SFT}$ã€‚</p>\n<p><strong>æ•°æ®å½¢å¼</strong>ï¼š$(\\text{prompt } x, \\text{é«˜è´¨é‡å›ç­” } y)$</p>\n<p><strong>æŸå¤±å‡½æ•°</strong>ï¼šæ ‡å‡†çš„ç›‘ç£å­¦ä¹ æŸå¤±å‡½æ•°</p>\n<script type=\"math/tex; mode=display\">\\max_{\\theta} \\sum_{(x,y) \\in D} \\log \\pi_\\theta(y|x)</script><ul>\n<li>$\\pi_\\theta$ï¼šç­–ç•¥æ¨¡å‹çš„å‚æ•°åŒ–å½¢å¼</li>\n<li>$D$ï¼šç›‘ç£å¾®è°ƒæ•°æ®é›†</li>\n<li>$x$ï¼šè¾“å…¥æç¤º</li>\n<li>$y$ï¼šç›®æ ‡å›ç­”</li>\n</ul>\n<p><strong>ç›®æ ‡</strong>ï¼šè®©æ¨¡å‹å­¦ä¼šåŸºæœ¬çš„å¯¹è¯èƒ½åŠ›å’Œä»»åŠ¡å®Œæˆèƒ½åŠ›ï¼Œå³â€æ€ä¹ˆè¯´è¯â€</p>\n<h4 id=\"é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward-Modelingï¼‰\"><a href=\"#é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward-Modelingï¼‰\" class=\"headerlink\" title=\"é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward Modelingï¼‰\"></a>é˜¶æ®µäºŒï¼šå¥–åŠ±æ¨¡å‹ï¼ˆReward Modelingï¼‰</h4><p>ä½¿ç”¨ SFT æ¨¡å‹ï¼Œå¯¹åŒä¸€ä¸ª prompt $x$ é‡‡æ ·ä¸¤ä¸ªå›ç­”ï¼š</p>\n<script type=\"math/tex; mode=display\">y_1, y_2 \\sim \\pi_{SFT}(y|x)</script><p>äº¤ç»™äººç±»æ ‡æ³¨è€…ï¼Œè®©ä»–ä»¬é€‰æ›´å¥½çš„ä¸€ä¸ªï¼š</p>\n<script type=\"math/tex; mode=display\">y_w \\succ y_l \\mid x</script><ul>\n<li>$y_w$ï¼šwinner,preferredï¼ˆèµ¢å®¶ï¼‰</li>\n<li>$y_l$ï¼šloser,rejectedï¼ˆè¾“å®¶ï¼‰</li>\n</ul>\n<p><strong>æ½œåœ¨å¥–åŠ±å‡½æ•°å‡è®¾</strong>ï¼šå‡è®¾äººç±»åå¥½æ˜¯ç”±ä¸€ä¸ªæœªçŸ¥çš„çœŸå®å¥–åŠ±å‡½æ•° $r^*(x,y)$ ç”Ÿæˆçš„ã€‚æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒï¼Œä½†å‡è®¾å®ƒå­˜åœ¨ã€‚</p>\n<p><strong>åå¥½æ¨¡å‹</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">p^*(y_1 > y_2 | x) = \\frac{\\exp(r^*(x, y_1))}{\\exp(r^*(x, y_1)) + \\exp(r^*(x, y_2))} \\tag{1}</script><p><strong>æ•°æ®é›†å½¢å¼</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">D = \\{(x^{(i)}, y_w^{(i)}, y_l^{(i)})\\}_{i=1}^N</script><p><strong>æŸå¤±å‡½æ•°</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathcal{L}_\\text{R}(r_\\phi, \\mathcal{D}) = -\\mathbb{E}_{(x, y_w, y_l) \\sim \\mathcal{D}} \\left[ \\log \\sigma (r_\\phi(x, y_w) - r_\\phi(x, y_l)) \\right] \\tag{2}</script><hr>\n<h5 id=\"è¡¥å……è§£é‡Š\"><a href=\"#è¡¥å……è§£é‡Š\" class=\"headerlink\" title=\"è¡¥å……è§£é‡Š\"></a>è¡¥å……è§£é‡Š</h5><p>BT æ¨¡å‹ï¼š</p>\n<p>Bradley-Terry æ¨¡å‹æ˜¯ä¸€ä¸ªç”¨äº<strong>æˆå¯¹æ¯”è¾ƒ</strong>çš„æ¦‚ç‡æ¨¡å‹</p>\n<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>\n<ul>\n<li>æ¯ä¸ªå¯¹è±¡ $i$ æœ‰ä¸€ä¸ªéšè—çš„â€å®åŠ›å€¼â€å‚æ•° $\\lambda_i$</li>\n<li>å½“ä¸¤ä¸ªå¯¹è±¡ $i$ å’Œ $j$ æ¯”è¾ƒæ—¶ï¼Œ$i$ æˆ˜èƒœ $j$ çš„æ¦‚ç‡ä¸ºï¼š</li>\n</ul>\n<script type=\"math/tex; mode=display\">P(i \\succ j) = \\frac{\\lambda_i}{\\lambda_i + \\lambda_j}</script><p><strong>åœ¨ DPO ä¸­çš„åº”ç”¨</strong>ï¼š</p>\n<ul>\n<li>å°†å¥–åŠ±å‡½æ•° $r(x,y)$ çœ‹ä½œâ€å®åŠ›å€¼â€</li>\n<li>äººç±»åå¥½ $ y_w \\succ y_l $ å°±æ˜¯â€æ¯”è¾ƒç»“æœâ€</li>\n<li>é€šè¿‡ BT æ¨¡å‹å»ºç«‹å¥–åŠ±ä¸åå¥½çš„æ¡¥æ¢</li>\n</ul>\n<p>ä¸ºä»€ä¹ˆä¸ç”¨ã€Œè°åˆ†æ•°å¤§å°±é€‰è°ã€ï¼Ÿ</p>\n<p>å¦‚æœç›´æ¥è§„å®šï¼š<script type=\"math/tex\">y_1 \\succ y_2 \\iff r^*(x,y_1) > r^*(x,y_2)</script><br>é‚£é—®é¢˜æ˜¯ï¼šäººç±»åˆ¤æ–­æœ‰å™ªå£°ï¼ŒåŒä¸€ä¸ªäººã€åŒä¸€ä¸ªé—®é¢˜ï¼Œä¸ä¸€å®šæ¯æ¬¡é€‰åŒæ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å»ºæ¨¡æˆç¡®å®šæ€§è§„åˆ™ï¼Œè€Œæ˜¯ï¼šæ¦‚ç‡æ¨¡å‹</p>\n<p>æŠŠå…¬å¼ (1) æ”¹å†™ä¸€ä¸‹ï¼š</p>\n<script type=\"math/tex; mode=display\">p^*(y_1 \\succ y_2 \\mid x) = \\frac{1}{1 + e^{-(r^*(x,y_1) - r^*(x,y_2))}}</script><p>è¿™å°±æ˜¯ç†Ÿæ‚‰çš„ Sigmoid å‡½æ•°ï¼š</p>\n<script type=\"math/tex; mode=display\">\\sigma(z) = \\frac{1}{1 + e^{-z}}</script><p>äºæ˜¯ï¼š</p>\n<script type=\"math/tex; mode=display\">p^*(y_1 \\succ y_2 \\mid x) = \\sigma(r^*(x,y_1) - r^*(x,y_2))</script><p>å› ä¸ºçœŸå®æ•°æ®é‡Œäººç¡®å®é€‰æ‹©äº† $ y_w $ï¼Œæ‰€ä»¥è¯¥äº‹ä»¶çš„æ¦‚ç‡æ˜¯ä¸Šå¼ï¼Œå¯¹æ•°ä¼¼ç„¶æ˜¯ï¼š</p>\n<script type=\"math/tex; mode=display\">\\log p_\\theta(y_w \\succ y_l \\mid x) = \\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))</script><p>æœ€å¤§åŒ–æ‰€æœ‰æ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶ï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_\\theta \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))</script><p>æ„æ€æ˜¯ï¼šå¯¹æ¯ä¸€æ¡æ•°æ®ï¼Œéƒ½ç®—ä¸€æ¬¡â€æ¨¡å‹è®¤ä¸ºäººç±»ä¼šé€‰èµ¢å®¶çš„æ¦‚ç‡çš„å¯¹æ•°â€ï¼Œç„¶åæŠŠå®ƒä»¬åŠ èµ·æ¥ï¼Œè®©è¿™ä¸ªæ€»å’Œå°½å¯èƒ½å¤§ã€‚å¯¹æ•°æŠŠâ€œè¿ä¹˜â€å˜æˆâ€œè¿åŠ â€,æœ€ä¼˜è§£ä¸å˜(å¯¹æ•°æ˜¯å•è°ƒé€’å¢å‡½æ•°)</p>\n<p>ç­‰ä»·åœ°ï¼Œæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆLikelihoodï¼‰ï¼š</p>\n<script type=\"math/tex; mode=display\">L_R = -\\mathbb{E}_{(x,y_w,y_l) \\sim D} [\\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))]</script><p>è¿™æ­£æ˜¯å…¬å¼ (2)ã€‚æ„æ€æ˜¯ï¼šå¯¹æ•°æ®é›†é‡Œçš„æ ·æœ¬å–å¹³å‡ï¼Œç„¶åå¯¹â€å¯¹æ•°æ¦‚ç‡â€å–è´Ÿå·ï¼Œè®©è¿™ä¸ªå€¼å°½å¯èƒ½å°ã€‚</p>\n<p>å¯¹ä¸€ä¸ªæœ‰é™æ•°æ®é›† $D = {z_1, â€¦, z_N}$ï¼Œå¦‚æœä½ å‡åŒ€éšæœºä»ä¸­æŠ½ä¸€ä¸ªæ ·æœ¬ï¼Œé‚£ä¹ˆï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{z \\sim D} [f(z)] = \\frac{1}{N} \\sum_{i=1}^N f(z_i)</script><p>ğŸ‘‰ æœŸæœ› = å¹³å‡å€¼</p>\n<p>ä»¤ $f(x,y_w,y_l) = \\log \\sigma(r_\\theta(x,y_w) - r_\\theta(x,y_l))$ é‚£ä¹ˆï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{(x,y_w,y_l) \\sim D} [f] = \\frac{1}{N} \\sum_{i=1}^N \\log \\sigma(r_\\theta(x^{(i)}, y_w^{(i)}) - r_\\theta(x^{(i)}, y_l^{(i)}))</script><p>å› ä¸º $\\sum_{i=1}^N f_i$ å’Œ $\\frac{1}{N} \\sum_{i=1}^N f_i$ åªå·®ä¸€ä¸ªå¸¸æ•° $\\frac{1}{N}$ã€‚è€Œåœ¨ä¼˜åŒ–ä¸­ï¼šä¹˜ä»¥ä¸€ä¸ªæ­£çš„å¸¸æ•°ï¼Œä¸ä¼šæ”¹å˜æœ€ä¼˜è§£çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼š<script type=\"math/tex\">\\arg\\max\\_\\theta \\sum\\_{i=1}^N f\\_i = \\arg\\max\\_\\theta \\frac{1}{N} \\sum\\_{i=1}^N f\\_i</script></p>\n<p>åŸç›®æ ‡ï¼š<script type=\"math/tex\">\\max_\\theta \\mathbb{E}_D [\\log \\sigma(\\cdots)]</script></p>\n<p>ç­‰ä»·äºï¼š<script type=\"math/tex\">\\min_\\theta -\\mathbb{E}_D [\\log \\sigma(\\cdots)]</script></p>\n<p>äºæ˜¯å®šä¹‰ï¼š<script type=\"math/tex\">L_R = -\\mathbb{E}_D [\\log \\sigma(\\cdots)]</script></p>\n<p><strong>ä¸ºä»€ä¹ˆæœºå™¨å­¦ä¹ é‡Œâ€æ€»æ˜¯æœ€å°åŒ–â€ï¼Ÿ</strong></p>\n<p>å› ä¸ºæ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰é»˜è®¤æ˜¯ minimize lossï¼Œæ‰€ä»¥å¤§å®¶ä¹ æƒ¯ï¼šæŠŠâ€æƒ³æœ€å¤§åŒ–çš„ç›®æ ‡â€ï¼Œå†™æˆâ€è¦æœ€å°åŒ–çš„æŸå¤±â€ã€‚</p>\n<hr>\n<h4 id=\"é˜¶æ®µä¸‰ï¼šRL-å¾®è°ƒ\"><a href=\"#é˜¶æ®µä¸‰ï¼šRL-å¾®è°ƒ\" class=\"headerlink\" title=\"é˜¶æ®µä¸‰ï¼šRL å¾®è°ƒ\"></a>é˜¶æ®µä¸‰ï¼šRL å¾®è°ƒ</h4><p><strong>RL ç›®æ ‡å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r_\\phi(x, y) - \\beta D_{\\text{KL}} \\left[ \\pi_\\theta(y|x) \\middle\\| \\pi_{\\text{ref}}(y|x) \\right] \\right] \\tag{3}</script><hr>\n<h5 id=\"è¡¥å……è§£é‡Š-1\"><a href=\"#è¡¥å……è§£é‡Š-1\" class=\"headerlink\" title=\"è¡¥å……è§£é‡Š\"></a>è¡¥å……è§£é‡Š</h5><p>ä¸€å¥è¯è§£é‡Šï¼šğŸ‘‰ è®©æ¨¡å‹ç”Ÿæˆ å¥–åŠ±é«˜çš„å›ç­” ğŸ‘‰ ä½†ä¸èƒ½åç¦»åŸå§‹ SFT æ¨¡å‹å¤ªè¿œ</p>\n<p>$\\pi_{ref}$ï¼ˆå³åˆå§‹ SFT æ¨¡å‹ $\\pi_{SFT}$ï¼‰å®è·µä¸­ï¼Œè¯­è¨€æ¨¡å‹ç­–ç•¥ $\\pi_\\theta$ ä¹Ÿè¢«åˆå§‹åŒ–ä¸º $\\pi_{SFT}$ã€‚</p>\n<ul>\n<li><strong>åˆå§‹çŠ¶æ€</strong>ï¼š$\\pi_\\theta = \\pi_{ref} = \\pi_{SFT}$</li>\n<li><strong>è®­ç»ƒç›®æ ‡</strong>ï¼šåœ¨ä¿æŒä¸åŸå§‹ SFT æ¨¡å‹æ¥è¿‘çš„å‰æä¸‹ï¼Œä¼˜åŒ–å¥–åŠ±</li>\n<li><strong>KL çº¦æŸä½œç”¨</strong>ï¼šç¡®ä¿æ¨¡å‹ä¸ä¼šåç¦»åˆå§‹èƒ½åŠ›å¤ªè¿œ</li>\n</ul>\n<p><strong>KL çº¦æŸï¼š</strong></p>\n<p>KL æ•£åº¦ï¼ˆKullback-Leibler æ•£åº¦ï¼‰è¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[P \\| Q] = \\sum_x P(x) \\log \\frac{P(x)}{Q(x)}</script><script type=\"math/tex; mode=display\">D_{\\text{KL}}[\\pi_\\theta(y|x) \\| \\pi_{SFT}(y|x)] = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]</script><p>è¿™è¡¨ç¤ºï¼š</p>\n<ul>\n<li>å¦‚æœ $\\pi_\\theta$ å’Œ $\\pi_{SFT}$ ç›¸åŒï¼šKL = 0</li>\n<li>å¦‚æœ $\\pi_\\theta$ åç¦» $\\pi_{SFT}$ï¼šKL &gt; 0</li>\n<li>ç›®æ ‡å‡½æ•°ä¸­çš„ $-\\beta KL$ æƒ©ç½šåç¦»è¡Œä¸º</li>\n</ul>\n<p><strong>KL æ•£åº¦æ¨å¯¼è¿‡ç¨‹è¯¦è§£</strong></p>\n<p><strong>KL æ•£åº¦çš„é€šç”¨å®šä¹‰ï¼ˆç¦»æ•£å‹ï¼‰</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[P \\| Q] = \\sum_i P(i) \\log \\frac{P(i)}{Q(i)}</script><p><strong>æœŸæœ›çš„å®šä¹‰</strong>ï¼š<br>å¯¹äºéšæœºå˜é‡ $Y \\sim P$ï¼Œå‡½æ•° $f(Y)$ çš„æœŸæœ›å®šä¹‰ä¸ºï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{Y \\sim P}[f(Y)] = \\sum_{y \\in \\mathcal{Y}} P(y) f(y)</script><p><strong>è¿›è¡Œå˜é‡æ˜ å°„</strong></p>\n<p>åœ¨ RLHF çš„è¯­å¢ƒä¸‹ï¼Œæˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯ä¸¤ä¸ªæ¨¡å‹ç­–ç•¥ï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰ä¹‹é—´çš„å·®å¼‚ï¼š</p>\n<ul>\n<li>$P$<strong> (å½“å‰åˆ†å¸ƒ)</strong>ï¼š$\\pi_\\theta(y|x)$ â€”â€” æ¨¡å‹å½“å‰æ­£åœ¨å­¦ä¹ çš„ç­–ç•¥</li>\n<li>$Q$<strong> (å‚è€ƒåˆ†å¸ƒ)</strong>ï¼š$\\pi_{SFT}(y|x)$ â€”â€” åŸå§‹çš„ SFT ç­–ç•¥</li>\n<li><strong>æ ·æœ¬ç©ºé—´</strong>ï¼š$y$ï¼ˆæ¨¡å‹ç”Ÿæˆçš„æ‰€æœ‰å¯èƒ½çš„å›ç­”åºåˆ—ï¼‰</li>\n</ul>\n<p>å°†è¿™äº›ä»£å…¥é€šç”¨å…¬å¼ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\sum_y \\pi_\\theta(y|x) \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)}</script><p><strong>è½¬åŒ–ä¸ºæœŸæœ›å½¢å¼</strong></p>\n<ul>\n<li>å¤–å±‚çš„ $\\sum_y \\pi_\\theta(y|x)(\\cdots)$ è¡¨ç¤ºæˆ‘ä»¬åœ¨æŒ‰ç…§ $\\pi_\\theta(y|x)$ çš„æ¦‚ç‡åˆ†å¸ƒå¯¹åé¢çš„é¡¹è¿›è¡ŒåŠ æƒå¹³å‡</li>\n<li>æ‹¬å·é‡Œçš„é¡¹ $\\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)}$ å°±æ˜¯è¦è®¡ç®—æœŸæœ›çš„å¯¹è±¡</li>\n</ul>\n<p>å› æ­¤ï¼Œæ ¹æ®æœŸæœ›çš„å®šä¹‰ $ \\sum P \\cdot f = \\mathbb{E}_P[f] $ï¼Œå¯ä»¥ç›´æ¥å†™æˆï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}[\\pi_\\theta \\| \\pi_{SFT}] = \\mathbb{E}_{y \\sim \\pi_\\theta(y|x)} \\left[ \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]</script><p><strong>ä¸ºä»€ä¹ˆå®è·µä¸­è¦å†™æˆæœŸæœ›å½¢å¼ï¼Ÿ</strong></p>\n<p>åœ¨æ·±åº¦å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ä¸­ï¼Œå†™æˆæœŸæœ›å½¢å¼æœ‰é‡å¤§çš„å·¥ç¨‹æ„ä¹‰ï¼š</p>\n<p><strong>æ— æ³•å…¨é‡æ±‚å’Œ</strong>ï¼š<br>å¯¹äºè¯­è¨€æ¨¡å‹ï¼Œå¯èƒ½çš„å›ç­” $y$ çš„ç»„åˆæ˜¯å¤©æ–‡æ•°å­—ï¼ˆç”±è¯è¡¨å¤§å°å’Œåºåˆ—é•¿åº¦å†³å®šï¼‰ï¼Œæˆ‘ä»¬æ ¹æœ¬æ— æ³•éå†æ‰€æœ‰çš„ $y$ æ¥è®¡ç®—é‚£ä¸ª $\\sum$ ç¬¦å·ã€‚</p>\n<p><strong>è’™ç‰¹å¡æ´›é‡‡æ ·ï¼ˆMonte Carlo Samplingï¼‰</strong>ï¼š<br>æœŸæœ›å½¢å¼å‘Šè¯‰æˆ‘ä»¬ï¼Œè™½ç„¶ä¸èƒ½éå†æ‰€æœ‰ç»“æœï¼Œä½†å¯ä»¥é€šè¿‡é‡‡æ ·æ¥è¿‘ä¼¼ï¼šè®©æ¨¡å‹ $\\pi_\\theta$ ç”Ÿæˆï¼ˆSampleï¼‰ä¸€æ‰¹å¥å­ $y$,è®¡ç®—è¿™äº›å¥å­çš„ $\\log \\pi_\\theta(y|x) - \\log \\pi_{SFT}(y|x)$,å–è¿™äº›å€¼çš„å¹³å‡å€¼ï¼Œå°±æ˜¯å¯¹ KL æ•£åº¦çš„æ— åä¼°è®¡</p>\n<p><strong>å¯¹é½ç›®æ ‡å‡½æ•°</strong>ï¼š<br>RL çš„ç›®æ ‡å‡½æ•°æœ¬èº«å°±æ˜¯æœ€å¤§åŒ–æœŸæœ›å¥–åŠ± $\\mathbb{E}_{y \\sim \\pi_\\theta}[r(x,y)]$ã€‚å°† KL çº¦æŸä¹Ÿå†™æˆæœŸæœ›å½¢å¼ï¼Œå°±å¯ä»¥åˆå¹¶åˆ°ä¸€ä¸ªå¤§æ‹¬å·é‡Œï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_{\\pi_\\theta} \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r(x,y) - \\beta \\log \\frac{\\pi_\\theta(y|x)}{\\pi_{SFT}(y|x)} \\right]</script><p>è¿™æ ·ï¼Œæ¨¡å‹åœ¨æ¯ä¸€è½®è®­ç»ƒé‡‡æ ·æ—¶ï¼Œå°±å¯ä»¥åŒæ—¶ä¼˜åŒ–å¥–åŠ±å¹¶è®¡ç®— KL æƒ©ç½šã€‚</p>\n<p><strong>ä¸ºä»€ä¹ˆè¿™ä¸ªç›®æ ‡å‡½æ•°ä¸å¯å¯¼ï¼Ÿ</strong></p>\n<p>è¯­è¨€æ¨¡å‹æ˜¯<strong>ç¦»æ•£ç”Ÿæˆ</strong>çš„ï¼š</p>\n<ul>\n<li>è¾“å‡ºæ˜¯ token åºåˆ— $y = (y_1, y_2, \\ldots)$</li>\n<li>é‡‡æ · / argmax éƒ½æ˜¯ç¦»æ•£æ“ä½œ</li>\n</ul>\n<p>æ— æ³•åƒæ™®é€šç›‘ç£å­¦ä¹ é‚£æ ·ï¼Œå¯¹ $\\mathbb{E}_{y \\sim \\pi_\\theta(y|x)}[r(x,y)]$ ç›´æ¥å¯¹ $\\theta$ æ±‚æ¢¯åº¦ã€‚</p>\n<p>ğŸ‘‰ æ‰€ä»¥ä¸èƒ½ç”¨åå‘ä¼ æ’­ç›´æ¥ä¼˜åŒ–å¥–åŠ±<br>ğŸ‘‰ å¿…é¡»ç”¨å¼ºåŒ–å­¦ä¹ ï¼ˆpolicy gradientï¼‰</p>\n<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨ REINFORCE / PPOã€‚</p>\n<p><strong>KL çº¦æŸæ˜¯æ€ä¹ˆå˜æˆâ€å¥–åŠ±â€çš„ï¼Ÿ</strong></p>\n<p><strong>å…³é”®ä¸€æ­¥æ˜¯ï¼šæŠŠå…¬å¼ (3) KL é¡¹å†™æˆ log-prob çš„å½¢å¼</strong></p>\n<p>å¯¹ç¦»æ•£ç­–ç•¥ï¼š</p>\n<script type=\"math/tex; mode=display\">D_{\\text{KL}}(\\pi_\\theta \\| \\pi_{ref}) = \\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right]</script><p><strong>ä»£å›ç›®æ ‡å‡½æ•°</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">\\mathbb{E}_{y \\sim \\pi_\\theta} \\left[ r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right) \\right]</script><p><strong>äºæ˜¯å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–°çš„ reward</strong>ï¼š</p>\n<script type=\"math/tex; mode=display\">r(x, y) = r_\\phi(x, y) - \\beta \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)</script><p>å³è®ºæ–‡ä¸­çš„ï¼š</p>\n<script type=\"math/tex; mode=display\">r(x, y) = r_\\phi(x, y) - \\left( \\log \\pi_\\theta(y|x) - \\log \\pi_{ref}(y|x) \\right)</script><p>ï¼ˆè®ºæ–‡é‡Œé€šå¸¸æŠŠ $\\beta$ çœç•¥æˆ–å¸æ”¶åˆ°ç³»æ•°é‡Œï¼‰</p>\n<p><strong>è½¬æ¢åçš„ç®€åŒ–ç›®æ ‡å‡½æ•°</strong></p>\n<p>é€šè¿‡è¿™ä¸ªå˜æ¢ï¼ŒåŸæ¥çš„çº¦æŸä¼˜åŒ–é—®é¢˜å˜æˆäº†æ— çº¦æŸçš„å¥–åŠ±æœ€å¤§åŒ–é—®é¢˜ï¼š</p>\n<script type=\"math/tex; mode=display\">\\max_{\\pi_\\theta} \\mathbb{E}_{x \\sim \\mathcal{D}, y \\sim \\pi_\\theta(y|x)} \\left[ r(x, y) \\right]</script><p>å…¶ä¸­ $r(x, y)$ å·²ç»åŒ…å«äº† KL æƒ©ç½šé¡¹ã€‚</p>\n<hr>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cmlje1itt000180zkf7x02dj4","category_id":"cmlje1itv000380zk2jni2ghq","_id":"cmlje1itx000680zk5ryj6ksu"}],"PostTag":[{"post_id":"cmlje1itt000180zkf7x02dj4","tag_id":"cmlje1itw000480zkfy816z67","_id":"cmlje1itx000580zkcia6che9"}],"Tag":[{"name":"LLM","_id":"cmlje1itw000480zkfy816z67"}]}}